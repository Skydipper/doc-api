<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index " data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo-skydipper.png" alt="Logo skydipper" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://ui.skydipper.com'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<h1 id="welcome-to-the-skydipper-api-documentation">Welcome to the Skydipper API Documentation.</h1>

          <h1 id="authentication">Authentication</h1>

<p>The Skydipper API uses JWT <a href="https://tools.ietf.org/html/rfc7519">(JSON Web Tokens)</a> to identify and authenticate its users. This token must be provided inside an <code class="prettyprint">Authorization</code> header, with the form <code class="prettyprint">Bearer: &lt;token&gt;</code>.</p>

<p>However, in order to perform GET requests for content that is not private, there&rsquo;s no need for any sort of authentication or token.</p>

<h2 id="how-to-create-a-new-user">How to create a new user</h2>

<p>To create a new user make a request like the one in the sidebar:</p>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/auth/user <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"&lt;email&gt;",
    "role":"&lt;role&gt;",
    "extraUserData": {
      "apps": [
        "&lt;apps&gt;"
      ]
    }
}'</span>
</code></pre>
<p>There are three allowed roles: <code class="prettyprint">USER</code>, <code class="prettyprint">MANAGER</code> and <code class="prettyprint">ADMIN</code>. The &lsquo;apps&rsquo; field only permits applications that are powered by the API: for now the only application is <code class="prettyprint">skydipper</code>, but some more will be available in the future.</p>

<h2 id="how-to-generate-your-private-token">How to generate your private token</h2>

<p>Endpoint for email + password based login.</p>
<pre class="highlight shell"><code><span class="c"># Email + password based login - JSON format</span>
curl -X POST http://api.skydipper.com/auth/login <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"your-email@provider.com",
    "password":"potato"
}'</span>
</code></pre>
<p>Refer to <a href="#user-management">user management</a> for more information on the operations available in the Skydipper API for managing user accounts, token generation, etc.</p>

          <h1 id="basemaps">Basemaps</h1>

<p>The Basemap microservice serves pre-calculated and dynamic tiles for Layer objects and several pre-built styles.
The code for this service can be found <a href="https://github.com/Skydipper/Basemaps">here</a>.</p>

<h2 id="annual-landsat-basemaps">Annual Landsat Basemaps</h2>

<p>We have created satellite basemaps based off of the NASA/USGS Landsat satellite collection. These are avaiable as <a href="https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames">slippy map tiles</a>.
We are continuing to add years of coverage to our Landsat Basemap collection. The collection we have currently processed
is avaiable via <code class="prettyprint">https://api.skydipper.com/v1/landsat/&lt;year&gt;/&lt;z&gt;/&lt;x&gt;/&lt;y&gt;</code>.</p>

<p>The service mixes pre-cached and dynamic tiles. The dynamic tiles kick-in at z&gt;11.</p>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/basemaps/landsat/2016/14/8473/7643"</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'./image_test.jpg'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">handler</span><span class="p">:</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre>
<h2 id="layer-basemaps">Layer Basemaps</h2>

<p>Appropriate layers in Skydipper (i.e. geospatial data, with either the EE or CartoDB provider and visulisation properties)
can be visulised as map tiles by calling <code class="prettyprint">https://api.skydipper.com/v1/basemaps/layer/&lt;layer_id&gt;/&lt;z&gt;/&lt;x&gt;/&lt;y&gt;</code>.</p>

<aside class="notice">
Rember, you can set the styles that control how the layer will appear using inside the Layer object. The style you set
should use either CartoCSS, mapbox vector styels, or the open standard SLD method (for rasters) depending on the data.
</aside>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/basemaps/layer/e7070d5f-3d38-46b1-86eb-e98782da55dd/14/8473/7643"</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'./image_test.jpg'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">handler</span><span class="p">:</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre>
<h2 id="movie-tiles">Movie tiles</h2>

<p>Coming soon.</p>

          <h1 id="composite-imagery">Composite Imagery</h1>

<p>The Composite service enables the creation of on-the-fly composites based on either Landsat-8, or Sentinel-2
and a Geostore geometry ID. Composites can be returned in a variety of formats, either as url links to
thumbnail and slippy map (z/x/y) tile assets, or as a zip folder containing image assets.</p>

<p>Band visulisations can be given as argument to visulise any bands of interest in RGB space.
Digital Elevation Model (DEM) image assets can also be returned with the <code class="prettyprint">get_dem</code>=True flag.</p>

<p>Code for the Composite service is <a href="https://github.com/Skydipper/Composite">hosted on Github</a>.</p>

<h2 id="thumbnails-and-slippy-maps">Thumbnails and slippy maps</h2>

<p>By default, the service accepts a Gestore id hash as an argument via the <code class="prettyprint">geostore</code> param in a <em>GET</em> request.
The response is JSON containing urls (with tokens valid for 2 days), linking to Z/X/Y type (slippy) maps, as well as
a thumbnail, and a greyscale Digital Elevation Model (DEM) output (if <code class="prettyprint">get_dem</code> is set to <em>True</em>).</p>
<pre class="highlight python"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"geostore"</span><span class="p">:</span> <span class="s">"&lt;geostore_id&gt;"</span><span class="p">,</span>
          <span class="s">"get_dem"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
          <span class="s">"date_range"</span><span class="p">:</span> <span class="s">"[2018-01-01, 2018-12-01]"</span><span class="p">,</span>
          <span class="s">"thumb_size"</span><span class="p">:</span> <span class="s">"[500, 500]"</span><span class="p">,</span>
          <span class="s">"instrument"</span><span class="p">:</span> <span class="s">"landsat"</span><span class="p">,</span>
          <span class="s">"cloudscore_thresh"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
          <span class="s">"band_vizz"</span><span class="p">:</span> <span class="s">"{'bands': ['B4', 'B3', 'B2'], 'min': 0, 'max': 0.4}"</span><span class="p">,</span>
          <span class="s">"get_files"</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="s">"https://api.skydipper.com/v1/composite-service"</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"dem"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://earthengine.googleapis.com/api/thumb?thumbid=6162ac5f8444eed070b537732711b688&amp;token=XXXX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"thumb_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://earthengine.googleapis.com/api/thumb?thumbid=580652e722a7660ab7137ffb21ce664e&amp;token=XXXXX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tile_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://earthengine.googleapis.com/map/1eaa150375fa8c9b1e00aa78f754f9d1/{z}/{x}/{y}?token=XXXXX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"zonal_stats"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">},</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"composite_service"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="downloading-image-assets">Downloading Image Assets</h2>

<p>Sometimes you want more than a thumnail and web map tiles. If you want to build 3D models with these assets you will
need to download the composite as a surface texture and apply that texture to a surface (ideally using the DEM
to deform the surface to show height also). To do this you will need to hit the service with <code class="prettyprint">get_files</code>=<em>True</em>, and then
unzip the assets folder that is returned in the response.</p>
<pre class="highlight python"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"geostore"</span><span class="p">:</span> <span class="s">"&lt;geostore_id&gt;"</span><span class="p">,</span>
          <span class="s">"get_dem"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
          <span class="s">"date_range"</span><span class="p">:</span> <span class="s">"[2019-01-01, 2019-12-01]"</span><span class="p">,</span>
          <span class="s">"thumb_size"</span><span class="p">:</span> <span class="s">"[250, 250]"</span><span class="p">,</span>
          <span class="s">"instrument"</span><span class="p">:</span> <span class="s">"landsat"</span><span class="p">,</span>
          <span class="s">"get_files"</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="s">"https://api.skydipper.com/v1/composite-service"</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre>
<aside class="notice">
The resolution of the downloaded images can be controled via the thumb_size parameter. E.g. if a 500x500 pixel image is required, pass the argument
thumb_size=[500,500].
</aside>

          <h1 id="dataset">Dataset</h1>

<h2 id="what-is-a-dataset">What is a Dataset?</h2>

<p>A dataset abstracts the data that can be obtained from several sources into a common interface. There are several data providers supported in the API, and each of those has a different provider. Datasets can belong to several applications.</p>

<h2 id="supported-dataset-sources">Supported dataset sources</h2>

<h3 id="third-party-dataset-connectors">Third party Dataset connectors</h3>

<p>For data stored on third party services.</p>

<h4 id="carto">Carto</h4>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;cartodb&#39;)</code></strong><br>
<a href="https://www.carto.com">CARTO</a> is an open, powerful, and intuitive map platform for discovering and predicting the key insights underlying the location data in our world.</p>

<h3 id="arcgis-feature-service">ArcGIS Feature service</h3>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;featureservice&#39;)</code></strong> <br>
<a href="https://www.arcgis.com/features/index.html">ArcGIS</a> for server is a Complete, Cloud-Based Mapping Platform.</p>

<h3 id="google-earth-engine">Google Earth Engine</h3>

<p><strong><code class="prettyprint">(connectorType: &#39;rest&#39;, provider: &#39;gee&#39;)</code></strong> <br>
<a href="https://earthengine.google.com/">Google Earth Engine</a> combines a multi-petabyte catalog of satellite imagery and geospatial datasets with planetary-scale analysis capabilities and makes it available for scientists, researchers, and developers to detect changes, map trends, and quantify differences on the Earth&rsquo;s surface.</p>

<h2 id="getting-all-datasets">Getting all datasets</h2>

<p>This endpoint will allow to get all datasets available in the API:</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"098b33df-6871-4e53-a5ff-b56a7d989f9a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subnational Political Boundaries"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Politcial-Boundaries-GADM-adminitrative-level-1-1490086842541"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tabular"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GADM"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"skydipper"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"dataPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributesPath"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"connectorType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rest"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57a0aa1071e394dd32ffe137"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"connectorUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://wri-01.carto.com/tables/gadm28_adm1/public"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gadm28_adm1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"overwrite"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"blockchain"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"subscribable"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mainDateField"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"geoInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"protected"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"legend"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"region"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"nested"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"clonedHost"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"errorMessage"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"taskId"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-21T13:54:56.285Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dataLastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.skydipper.com/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.skydipper.com/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.skydipper.com/v1/dataset?page[number]=99&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"prev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.skydipper.com/v1/dataset?page[number]=1&amp;page[size]=10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.skydipper.com/v1/dataset?page[number]=2&amp;page[size]=10"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">990</span><span class="p">,</span><span class="w">
    </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="slug-amp-dataset-id">Slug &amp; dataset-id</h3>

<p>Datasets have an auto-generated and unique slug and id that allows the user to get, create, update, query or clone that dataset.</p>

<p>The dataset slug and the id cannot be updated even if the name changes.</p>

<h3 id="error-message">Error Message</h3>

<p>When a dataset is created the status is set to &ldquo;pending&rdquo; by default. Once the adapter validates the dataset, the status is changed to &ldquo;saved&rdquo;. If the validation fails, the status will be set to &ldquo;failed&rdquo; and the adapter will also set an error message indicating the reason.</p>

<h3 id="filters">Filters</h3>

<p>The dataset list provided by the endpoint can be filtered with the following attributes:</p>

<table><thead>
<tr>
<th>Filter</th>
<th>Description</th>
<th>Accepted values</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Allow us to filter by name</td>
<td>any valid text</td>
</tr>
<tr>
<td>type</td>
<td>Allow us to distinguish between tabular and raster datasets</td>
<td><code class="prettyprint">raster</code> or <code class="prettyprint">tabular</code></td>
</tr>
<tr>
<td>app</td>
<td>Aplications to which this dataset is being used</td>
<td>Available Aplications like: <code class="prettyprint">[&quot;skydipper&quot;]</code></td>
</tr>
<tr>
<td>connectorType</td>
<td></td>
<td><code class="prettyprint">rest</code> (placeholder for future connectors not based in rest)</td>
</tr>
<tr>
<td>provider</td>
<td>Dataset provider this include inner connectors and 3rd party ones</td>
<td><a href="##supported-dataset-sources">A valid dataset provider</a></td>
</tr>
<tr>
<td>userId</td>
<td>the user who registered the dataset</td>
<td>valid id</td>
</tr>
<tr>
<td>status</td>
<td>the internal dataset status at connection time</td>
<td><code class="prettyprint">pending</code>, <code class="prettyprint">saved</code> or <code class="prettyprint">failed</code></td>
</tr>
<tr>
<td>published</td>
<td></td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>env</td>
<td>If the dataset is in preproduction envirenment or in production one</td>
<td><code class="prettyprint">production</code>or <code class="prettyprint">preproduction</code></td>
</tr>
<tr>
<td>overwritted</td>
<td>If the data can be overwritten (only for being able to make dataset updates)</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>verify</td>
<td>If this dataset contains data that is verified using blockchain</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>protected</td>
<td>If it&rsquo;s a protected layer</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>geoInfo</td>
<td>If it contains intersectable geographical info</td>
<td><code class="prettyprint">true</code>or <code class="prettyprint">false</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Filtering datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?name<span class="o">=</span>birds&amp;provider<span class="o">=</span>cartodb
</code></pre>
<blockquote>
<p>For inclusive filtering with array props use &rsquo;@&rsquo;</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?provider<span class="o">=</span>cartodb@gee
</code></pre>
<h3 id="sorting">Sorting</h3>

<h4 id="basics-of-sorting">Basics of sorting</h4>

<p>The API currently supports sorting by means of the <code class="prettyprint">sort</code> parameter. </p>

<blockquote>
<p>Sorting datasets</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>name
</code></pre>
<p>Multiple sorting criteria can be used, separating them by commas.</p>

<blockquote>
<p>Sorting datasets by multiple criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>name,description
</code></pre>
<p>You can specify the sorting order by prepending the criteria with either <code class="prettyprint">-</code> or <code class="prettyprint">+</code>. By default, <code class="prettyprint">asc</code> order is assumed.</p>

<blockquote>
<p>Explicit order of sorting</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>-name,+description
</code></pre>
<h4 id="special-sorting-criteria">Special sorting criteria</h4>

<p>There are two special sorting criteria:</p>

<ul>
<li><code class="prettyprint">metadata</code>: delegates sorting to the metadata component, sorting by the name field of the metadata.</li>
<li><code class="prettyprint">relevance</code>: delegates sorting to the metadata component, sorting by the datasets which metadata better match the search criteria. Can only be used in conjunction with a <code class="prettyprint">search</code> parameter. Does not support ascending order. </li>
</ul>

<p>Special search criteria must be used as sole sorting criteria, as it&rsquo;s not possible to combine any of them with any other search criteria.</p>

<blockquote>
<p>Sorting datasets with special criteria</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>relevance&amp;status<span class="o">=</span>saved&amp;search<span class="o">=</span>agriculture
</code></pre>
<h3 id="relationships">Relationships</h3>

<p>Available relationships: Any dataset relationship [&lsquo;metadata&rsquo;]</p>

<blockquote>
<p>Including relationships</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata
</code></pre>
<h3 id="pagination">Pagination</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">The number elements per page</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">The page number</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Paginating the output</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata&amp;page[number]<span class="o">=</span>1
curl -X GET https://api.skydipper.com/v1/dataset?sort<span class="o">=</span>slug,-provider,userId&amp;status<span class="o">=</span>saved&amp;includes<span class="o">=</span>metadata&amp;page[number]<span class="o">=</span>2
</code></pre>
<h2 id="how-to-get-a-specific-dataset">How to get a specific dataset</h2>

<blockquote>
<p>To get a dataset:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset/51943691-eebc-4cb4-bdfb-057ad4fc2145
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"data"</span>: <span class="o">{</span>
      <span class="s2">"id"</span>: <span class="s2">"098b33df-6871-4e53-a5ff-b56a7d989f9a"</span>,
      <span class="s2">"type"</span>: <span class="s2">"dataset"</span>,
      <span class="s2">"attributes"</span>: <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"Subnational Political Boundaries"</span>,
        <span class="s2">"slug"</span>: <span class="s2">"Politcial-Boundaries-GADM-adminitrative-level-1-1490086842541"</span>,
        <span class="s2">"type"</span>: <span class="s2">"tabular"</span>,
        <span class="s2">"subtitle"</span>: <span class="s2">"GADM"</span>,
        <span class="s2">"application"</span>: <span class="o">[</span><span class="s2">"skydipper"</span><span class="o">]</span>,
        <span class="s2">"dataPath"</span>: null,
        <span class="s2">"attributesPath"</span>: null,
        <span class="s2">"connectorType"</span>: <span class="s2">"rest"</span>,
        <span class="s2">"provider"</span>: <span class="s2">"cartodb"</span>,
        <span class="s2">"userId"</span>: <span class="s2">"57a0aa1071e394dd32ffe137"</span>,
        <span class="s2">"connectorUrl"</span>: <span class="s2">"https://wri-01.carto.com/tables/gadm28_adm1/public"</span>,
        <span class="s2">"tableName"</span>: <span class="s2">"gadm28_adm1"</span>,
        <span class="s2">"status"</span>: <span class="s2">"saved"</span>,
        <span class="s2">"published"</span>: <span class="nb">true</span>,
        <span class="s2">"overwrite"</span>: <span class="nb">false</span>,
        <span class="s2">"verified"</span>: <span class="nb">false</span>,
        <span class="s2">"blockchain"</span>: null,
        <span class="s2">"subscribable"</span>: null,
        <span class="s2">"mainDateField"</span>: null,
        <span class="s2">"env"</span>: <span class="s2">"production"</span>,
        <span class="s2">"geoInfo"</span>: <span class="nb">true</span>,
        <span class="s2">"protected"</span>: <span class="nb">true</span>,
        <span class="s2">"legend"</span>: <span class="o">{</span>
          <span class="s2">"date"</span>: <span class="o">[]</span>,
          <span class="s2">"region"</span>: <span class="o">[]</span>,
          <span class="s2">"country"</span>: <span class="o">[]</span>,
          <span class="s2">"nested"</span>: <span class="o">[]</span>
        <span class="o">}</span>,
        <span class="s2">"clonedHost"</span>: null,
        <span class="s2">"errorMessage"</span>: null,
        <span class="s2">"taskId"</span>: null,
        <span class="s2">"updatedAt"</span>: <span class="s2">"2018-11-21T13:54:56.285Z"</span>,
        <span class="s2">"dataLastUpdated"</span>: null
      <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<blockquote>
<p>To get the dataset including its relationships:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset/06c44f9a-aae7-401e-874c-de13b7764959?includes<span class="o">=</span>metadata
</code></pre>
<h2 id="creating-a-dataset">Creating a Dataset</h2>

<p>To create a dataset, you will need an authorization token. Follow the steps of this <a href="#generate-your-own-oauth-token">guide</a> to get yours.</p>

<p>To create a dataset, you need to define all of the required fields in the request body. The fields that compose a dataset are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Dataset name</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>type</td>
<td style="text-align: center">Dataset type</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>subtitle</td>
<td style="text-align: center">Dataset subtitle</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Applications the dataset belongs to</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">Any valid application name(s)</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>connectorType</td>
<td style="text-align: center">Connector type</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">rest, document, wms</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>provider</td>
<td style="text-align: center">The connectorType provider</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">cartodb, feature service, gee</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>connectorUrl</td>
<td style="text-align: center">Url of the data source</td>
<td style="text-align: right">Url</td>
<td style="text-align: right">Any url</td>
<td style="text-align: right">Yes (except for gee)</td>
</tr>
<tr>
<td>tableName</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid table name</td>
<td style="text-align: right">No (just for GEE datasets)</td>
</tr>
<tr>
<td>data</td>
<td style="text-align: center">JSON DATA only for json connector if connectorUrl not present</td>
<td style="text-align: right">JSON</td>
<td style="text-align: right">[{},{},{}]</td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
<tr>
<td>dataPath</td>
<td style="text-align: center">Path to the data in a json dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any valid JSON key</td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
<tr>
<td>dataAttributes</td>
<td style="text-align: center">Data fields - for json connector if data present</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">{&ldquo;key1&rdquo;: {&ldquo;type&rdquo;: &ldquo;string&rdquo;},&hellip; }</td>
<td style="text-align: right">No (just for json if connectorUrl is not present)</td>
</tr>
<tr>
<td>legend</td>
<td style="text-align: center">Legend for dataset. Keys for special fields</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">&ldquo;legend&rdquo;: {&ldquo;long&rdquo;: &ldquo;123&rdquo;, &ldquo;lat&rdquo;: &ldquo;123&rdquo;, &ldquo;country&rdquo;: [&ldquo;pais&rdquo;], &ldquo;region&rdquo;: [&ldquo;barrio&rdquo;], &ldquo;date&rdquo;: [&ldquo;startDate&rdquo;, &ldquo;endDate&rdquo;]}}</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>overwrite</td>
<td style="text-align: center">It allows to overwrite dataset data</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">To set a public or private dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>verified</td>
<td style="text-align: center">To generate a verified blockchain of the dataset</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true/false</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<p>There are some differences between datasets types.</p>

<h3 id="rest-carto-datasets">Rest-Carto datasets</h3>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "connectorType":"rest",
    "provider":"cartodb",
    "connectorUrl":"&lt;cartoUrl&gt;",
    "application":[
     "your", "apps"
    ],
    "name":"Example Carto Dataset"
}'</span>
</code></pre>
<blockquote>
<p>A real example:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"cartodb",
    "connectorUrl":"https://wri-01.carto.com/tables/wdpa_protected_areas/table",
    "application":[
    "skydipper"
    ],
    "name":"World Database on Protected Areas -- Global"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h3 id="rest-arcgis-feature-service">Rest-ArcGIS feature Service</h3>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"featureservice",
    "connectorUrl":"https://services.arcgis.com/uDTUpUPbk8X8mXwl/arcgis/rest/services/Public_Schools_in_Onondaga_County/FeatureServer/0?f=json",
    "application":[
    "skydipper"
    ],
    "name":"Uncontrolled Public-Use Airports -- U.S."
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h3 id="rest-gee">Rest-GEE</h3>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
<span class="s1">'{
    "connectorType":"rest",
    "provider":"gee",
    "tableName": "JRC/GSW1_0/GlobalSurfaceWater"
    "application":[
     "skydipper"
    ],
    "name":"Water occurrence"
}'</span>
</code></pre>
<h2 id="updating-a-dataset">Updating a Dataset</h2>

<p>In order to modify the dataset, you can PATCH a request. It accepts the same parameters as the <em>create dataset</em> endpoint, and you will need an authentication token.</p>

<blockquote>
<p>An example update request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
    "name": "Another name for the dataset"
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h2 id="deleting-a-dataset">Deleting a Dataset</h2>

<p><strong>When a dataset is deleted the user&rsquo;s applications that were present on the dataset will be removed from it. If this results in a dataset without applications, the dataset itself will be then deleted.</strong></p>

<p>Datasets can be deleted either by any user with role ADMIN or by the user with role MANAGER that created them. Note that the deletion process cascades; deleting a dataset will also remove all layer, vocabularies, and metadata entities associated with it.</p>

<aside class="warning">
Deleting a dataset removes it permanently! It is recommended that you save a local copy before doing so.
</aside>
<pre class="highlight shell"><code>curl -X DELETE https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

<h2 id="cloning-a-dataset">Cloning a Dataset</h2>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/5306fd54-df71-4e20-8b34-2ff464ab28be/clone <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
-H <span class="s2">"Content-Type: application/json"</span> -d <span class="se">\</span>
<span class="s1">'{
  "dataset": {
    "datasetUrl": "/query/5306fd54-df71-4e20-8b34-2ff464ab28be?sql=select%20%2A%20from%20data%20limit%2010",
    "application": [
      "your",
      "apps"
    ]
  }
}'</span>
</code></pre>
<aside class="notice">
    This is an authenticated endpoint!
</aside>

          <h1 id="fields">Fields</h1>

<h2 id="what-are-fields">What are fields?</h2>

<p>Fields can be defined as the dataset properties. These fields are automatically generated when a dataset is created.</p>

<h2 id="how-to-get-the-dataset-fields">How to get the dataset fields</h2>

<p>Once the dataset is properly created and saved, it is possible to access to its fields as well as getting some information about them.</p>

<p>To do that, it is necessary to use of the following endpoint:</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/fields/&lt;dataset-id&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/fields/1170030b-9725-4bfe-8fb4-1b0eb81020d2
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"public.cait_2_0_country_ghg_emissions_toplow2011"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"cartodb_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"the_geom_webmercator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geometry"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="layer">Layer</h1>

<h2 id="what-is-a-layer">What is a Layer?</h2>

<p>A layer is a geographical representation of a Dataset&rsquo;s data.</p>

<p>Layer contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>userId</td>
<td style="text-align: center">Id of the owner</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the dataset belongs</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>slug</td>
<td style="text-align: center">Unique identifier of the layer</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Url</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the layer</td>
<td style="text-align: right">Array</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset that the layer belongs</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>default</td>
<td style="text-align: center">If it&rsquo;s a default layer for the dataset that it belongs</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Is the layer published?</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">environment in witch the layer was published, one of <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<h2 id="how-obtain-all-layers">How obtain all layers</h2>

<p>To obtain all layers:</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer
</code></pre>
<aside class="success">
Remember  the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"skydipper"</span><span class="w">
          </span><span class="p">],</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"skydipper"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
              </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
              </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
          </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"first"</span><span class="p">:</span><span class="s2">"https://api.skydipper.com/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prev"</span><span class="p">:</span><span class="s2">"https://api.skydipper.com/v1/layer?page%5Bnumber%5D=1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next"</span><span class="p">:</span><span class="s2">"https://api.skydipper.com/v1/layer?page%5Bnumber%5D=2&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last"</span><span class="p">:</span><span class="s2">"https://api.skydipper.com/v1/layer?page%5Bnumber%5D=64&amp;page%5Bsize%5D=10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"https://api.skydipper.com/v1/layer?page%5Bnumber%5D=1&amp;page%5Bsize%5D=10"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"total-pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total-items"</span><span class="p">:</span><span class="w"> </span><span class="mi">628</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="filter-params">Filter params</h3>

<p>Available filters:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Filter the layers whose name contains the filter text</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">Filter the layers by dataset uuid</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>sort</td>
<td style="text-align: center">Sort json response by specific attributes</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>status</td>
<td style="text-align: center">Filter layers on status (pending, saved, failed, all)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>published</td>
<td style="text-align: center">Filter layers on published status (true, false)</td>
<td style="text-align: right">Boolean</td>
</tr>
<tr>
<td>app</td>
<td style="text-align: center">Filter layers on application (prep, gfw, etc..)</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>env</td>
<td style="text-align: center">Environment in witch the layer was published, one of <code class="prettyprint">preproduction</code> or <code class="prettyprint">production</code></td>
<td style="text-align: right">Text</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers filtered by those whose name contains emissions</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?name<span class="o">=</span>emissions
</code></pre>
<blockquote>
<p>Return the layers filtered by dataset</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?dataset<span class="o">=</span>11de2bc1-368b-42ed-a207-aaff8ece752b
curl -X GET https://api.skydipper.com/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer
</code></pre>
<blockquote>
<p>Sort by name</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?sort<span class="o">=</span>name
</code></pre>
<blockquote>
<p>Filter layers by status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?status<span class="o">=</span>failed
</code></pre>
<blockquote>
<p>Filter layers by published status</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?published<span class="o">=</span><span class="nb">false</span>
</code></pre>
<blockquote>
<p>Return the layers filtered by those whose applications contain skydipper</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?app<span class="o">=</span>skydipper
</code></pre>
<h3 id="pagination-params">Pagination params</h3>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>page[size]</td>
<td style="text-align: center">Number elements per page</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>page[number]</td>
<td style="text-align: center">Number of page</td>
<td style="text-align: right">Number</td>
</tr>
</tbody></table>

<blockquote>
<p>Return the layers of page 2 with 5 elements per page</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/layer?page[size]<span class="o">=</span>5&amp;page[number]<span class="o">=</span>2
</code></pre>
<h2 id="how-obtain-a-layer-for-specific-dataset">How obtain a layer for specific dataset</h2>

<p>To obtain the layer:</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset/11de2bc1-368b-42ed-a207-aaff8ece752b/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
curl -X GET https://api.skydipper.com/v1/layer/e5c3e7c5-19ae-4ca0-a461-71f1f67aa553
</code></pre>
<aside class="success">
Remember  the response is jsonapi format
</aside>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e5c3e7c5-19ae-4ca0-a461-71f1f67aa553"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"layer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"total-co2-emissions-by-year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5858f37140621f11066fb2f7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"skydipper"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Total CO2 emissions by year"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11de2bc1-368b-42ed-a207-aaff8ece752b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"layerConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"skydipper"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"maxzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
          </span><span class="s2">"minzoom"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="s2">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mapnik"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"sql"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * cait_2_0_country_ghg_emissions_filtered"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="s2">"cartocss_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.3.0"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"legendConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"marks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rect"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"table"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"applicationConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
      </span><span class="s2">"staticImageConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saved"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"published"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-23T16:51:42.571Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="create-a-layer">Create a Layer</h2>

<p>To create a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, skydipper, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">Isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>protected</td>
<td style="text-align: center">If it&rsquo;s a protected layer (not is possible to delete if it&rsquo;s true)</td>
<td style="text-align: right">Boolean</td>
<td style="text-align: right">true-false</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a layer, you have to do a POST request with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "application":[
       "your", "apps"
    ],
    "name":"Example layer",
    "status": 1
}'</span>
</code></pre>
<blockquote>
<p>The following structure was previously supported but should now be considered deprecated:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/&lt;dataset_id&gt;/layer <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"Example layer",
      "status": 1
   }
}'</span>
</code></pre>
<h2 id="update-a-layer">Update a Layer</h2>

<p>To update a layer, you need to define all of the required fields in the request body. The fields that compose a layer are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th style="text-align: right">Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td style="text-align: center">Name of the layer</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any Text</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">Description of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Any text</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>application</td>
<td style="text-align: center">Application to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">gfw, forest-atlas, skydipper, prep, aqueduct, data4sdg</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>layerConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>legendConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>applicationConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>staticImageConfig</td>
<td style="text-align: center">Custom configuration</td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Valid object</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>iso</td>
<td style="text-align: center">The isos to which the layer belongs</td>
<td style="text-align: right">Array</td>
<td style="text-align: right">BRA, ES</td>
<td style="text-align: right">No</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">UuId of the dataset</td>
<td style="text-align: right">Text</td>
<td style="text-align: right">Uuid of Dataset</td>
<td style="text-align: right">No</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a layer, you have to do a POST requestwith the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.skydipper.com/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "layer": {
      "application":[
         "your", "apps"
      ],
      "name":"New Example layer Name",
      "layerConfig": {}
   }
}'</span>
</code></pre>
<h2 id="delete-a-layer">Delete a Layer</h2>
<pre class="highlight shell"><code>curl -X DELETE https://api.skydipper.com/v1/dataset/&lt;dataset_id&gt;/layer/&lt;layer_id&gt; <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
          <h1 id="metadata">Metadata</h1>

<h2 id="metadata-definition">Metadata definition</h2>

<p>Metadata can be any kind of data associated to an existing resource (i.e. a dataset).</p>

<p>Some fields are important to identify the entity properly; others are just optional and give extra information about it.</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">The metadata application</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">The metadata language</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">The associated dataset id to the metadata</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>resource</td>
<td style="text-align: center">The resource associated to the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; id</td>
<td style="text-align: center">Resource id</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Resource type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">The metadata name</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">The metadata description</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">The metadata source</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">The metadata citation</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">The metadata license type</td>
<td style="text-align: right">String</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">Some info about the metadata</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">Measurement units</td>
<td style="text-align: right">Object</td>
</tr>
</tbody></table>

<h2 id="creating-a-metadata-object">Creating a metadata object</h2>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Required/Optional</th>
</tr>
</thead><tbody>
<tr>
<td>application</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>language</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>dataset</td>
<td style="text-align: center">required</td>
</tr>
<tr>
<td>name</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>description</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>source</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>citation</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>license</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>info</td>
<td style="text-align: center">optional</td>
</tr>
<tr>
<td>units</td>
<td style="text-align: center">optional</td>
</tr>
</tbody></table>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the payload.</p>

<aside class="notice">
Please, be sure that the request is properly authenticated and the current user has permission to the resource.
If you don&rsquo;t know how to do this, please go to the <a href="#authentication">Authentication section</a>
</aside>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "skydipper",
   "language": "en"
  }'</span>
</code></pre>
<blockquote>
<p>Response: 200 OK HTTP RESPONSE + JSON-API-LIKE BODY</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-rw-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"skydipper"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>It could respond with a <strong>401</strong> status code if the request is not authenticated, <strong>403</strong> if the request is not allowed to do that operation,
<strong>400</strong> if the request is not well formatted, or <strong>5XX</strong> HTTP codes in other cases.</p>
</blockquote>

<h2 id="getting-metadata">Getting metadata</h2>

<p>application filter:
<code class="prettyprint">
application: skydipper
</code></p>

<p>language filter:
<code class="prettyprint">
language: select between available languages (select one or some of them)
</code></p>

<p>limit filter:
<code class="prettyprint">
limit: the desired number
</code></p>

<p>Custom param for /metadata endpoint:
<code class="prettyprint">
type: [dataset]
</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt;/metadata
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata
</code></pre>
<h2 id="updating-a-metadata">Updating a metadata</h2>

<p>Partial update:</p>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the payload.</p>
<pre class="highlight shell"><code>curl -X PATCH https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt;/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": &lt;app&gt;,
   "language": &lt;language&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X PATCH https://api.skydipper.com/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "application": "skydipper",
   "language": "en",
   "name": "Cloud Computing Market - USA - 2016",
   "source": "http://www.forbes.com/",
   "info": {
       "summary": "These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazons decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales).",
       "author": "Louis Columbus",
       "date": "MAR 13, 2016 @ 10:42 PM",
       "link": "http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"
   }
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-skydipper-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"skydipper"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazons decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="deleting-a-metadata">Deleting a metadata</h2>

<p>The &ldquo;application&rdquo; and &ldquo;language&rdquo; attributes are required and it is mandatory to include them in the query params.</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.skydipper.com/v1/dataset/&lt;dataset-id&gt;/metadata?application<span class="o">=</span>&lt;app-id&gt;&amp;language<span class="o">=</span>&lt;language&gt;
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X DELETE https://api.skydipper.com/v1/dataset/942b3f38-9504-4273-af51-0440170ffc86/metadata?application<span class="o">=</span>skydipper&amp;language<span class="o">=</span>en <span class="se">\</span>
</code></pre>
<h2 id="getting-all">Getting all</h2>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata
</code></pre>
<blockquote>
<p>Real examples</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata?type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata?application<span class="o">=</span>skydipper&amp;language<span class="o">=</span>es,en&amp;limit<span class="o">=</span>20
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata?application<span class="o">=</span>skydipper,gfw&amp;language<span class="o">=</span>en&amp;type<span class="o">=</span>dataset
</code></pre><pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/metadata?language<span class="o">=</span>en
</code></pre>
<h2 id="finding-getting-by-ids">Finding (getting) by ids</h2>

<p>The &ldquo;ids&rdquo; property is required in the payload, and in other case the endpoint responds with a 400 HTTP ERROR (Bad Request)
This property can be an Array or a String (comma-separated)
payload -&gt; {&ldquo;ids&rdquo;: [&ldquo;112313&rdquo;, &ldquo;111123&rdquo;]}
payload -&gt; {&ldquo;ids&rdquo;: &ldquo;112313, 111123&rdquo;}</p>

<p>application filter:
<code class="prettyprint">
application: skydipper (select one or some of them)
</code></p>

<p>language filter:
<code class="prettyprint">
language: select between available languages (select one or some of them)
</code></p>

<p>limit filter:
<code class="prettyprint">
limit: the desired number
</code></p>

<p>Custom param for the metadata endpoint:
<code class="prettyprint">
type: [dataset]
</code></p>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "ids": [&lt;ids&gt;]
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/dataset/metadata/find-by-ids <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
     "ids": "b000288d-7037-43ba-aa34-165eab549613, 942b3f38-9504-4273-af51-0440170ffc86"
  }'</span>
</code></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613-dataset-b000288d-7037-43ba-aa34-165eab549613-prep-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prep"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b000288d-7037-43ba-aa34-165eab549613"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already locked in due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2F to +5.9F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
        </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"organization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe Casola, University of Washington"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Public domain"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://maca.northwestknowledge.net"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"citation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Abatzoglou, J. T.,   Brown, T. J. 2012. A comparison of statistical downscaling methods suited for wildfire applications. International Journal of Climatology, 32(5), 772-780. doi: http://dx.doi.org/10.1002/joc.2312 "</span><span class="p">,</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Puget Sound region is projected to warm rapidly during the 21st century. Prior to mid-century, the projected increase in air temperatures is about the same for all greenhouse gas scenarios, a result of the fact that a certain amount of warming is already locked in due to past emissions. After about 2050, projected warming depends on the amount of greenhouse gases emitted globally in the coming decades. For the 2050s (2040-2069, relative to 1970-1999), annual average air temperature is projected to rise +4.2F to +5.9F, on average, for a low (RCP 4.5) and a high (RCP 8.5) greenhouse gas scenario. These indicators are derived from the Multivariate Adaptive Constructed Analogs (MACA) CMIP5 Future Climate Dataset from the University of Idaho. For more information about this analysis, please see http://cses.washington.edu/picea/mauger/ps-sok/ps-sok_sec12_builtenvironment_2015.pdf. For more information about the MACA CMIP5 Future Climate Dataset please see http://maca.northwestknowledge.net/index.php"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"short-description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change in the Puget Sound Lowlands relative to average temperature between 1950-2005. Light colored lines in the background show the range of projections. All climate scenarios project warming for the Puget Sound region during the 21st century."</span><span class="p">,</span><span class="w">
          </span><span class="s2">"subtitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
          </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projected temperature change"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:02:28.337Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-13T10:03:02.445Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86-dataset-942b3f38-9504-4273-af51-0440170ffc86-skydipper-en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metadata"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dataset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="s2">"skydipper"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataset"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"942b3f38-9504-4273-af51-0440170ffc86"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cloud Computing Market - USA - 2016"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.forbes.com/sites/louiscolumbus/2016/03/13/roundup-of-cloud-computing-forecasts-and-market-estimates-2016/#5875cf0074b0"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAR 13, 2016 @ 10:42 PM"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Louis Columbus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"These and many other insights are from the latest series of cloud computing forecasts and market estimates produced by IDC, Gartner, Microsoft and other research consultancies. Amazons decision to break out AWS revenues and report them starting in Q1 FY2015 is proving to be a useful benchmark for tracking global cloud growth.  In their latest quarterly results released on January 28, Amazon reported that AWS generated $7.88B in revenues and attained a segment operating income of $1.863B. Please see page 8 of the announcement for AWS financials.  For Q4, AWS achieved a 28.5% operating margin (% of AWS net sales)."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:07:53.272Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-20T08:40:30.190Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"published"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="microservices">Microservices</h1>

<p>A list of information related to the microservices</p>

<aside class="notice">
    These services are only available to ADMIN users.
</aside>

<h2 id="list-all-registered-microservices">List all registered microservices</h2>

<p>To obtain a list of all the registered microservices:</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/api/v1/microservice <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"infoStatus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"numRetries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T14:05:30.748Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"pathInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pathLive"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/ping"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cache"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"uncache"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"dataset"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"dataset"</span><span class="w">

        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dataset"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dataset.default.svc.cluster.local:3000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"endpoints"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"redirect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/dataset/find-by-ids"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/dataset/find-by-ids"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-24T13:04:46.728Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"swagger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete-microservice">Delete microservice</h2>

<p>To remove a microservice:</p>
<pre class="highlight shell"><code>curl -X DELETE https://api.skydipper.com/api/v1/microservice/:id <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span>
</code></pre>
<h4 id="notes">Notes</h4>

<p>Keep in mind that this does not actually delete the microservice, instead it schedules it for being removed. 
There&rsquo;s a cron task that does the actual deleting, so the process is async.</p>

          <h1 id="geoai">GeoAI</h1>

<p>Service for statistical analysis tools.</p>

<h2 id="trends">Trends</h2>

<p>Examine long-term changes in a 1-D dataset, using moving average (box-car) de-treding (i.e. low-pass filter) and
a Monte Carlo resampling to calculate the significance of the low-frequency variance.</p>
<pre class="highlight python"><code><span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.skydipper.com/v1/geoai/trends"</span>

<span class="n">querystring</span> <span class="o">=</span> <span class="p">{</span><span class="s">"mc_number"</span><span class="p">:</span><span class="s">"10000"</span><span class="p">,</span>
               <span class="s">"bin_number"</span><span class="p">:</span><span class="s">"100"</span><span class="p">,</span>
               <span class="s">"window"</span><span class="p">:</span><span class="s">"5"</span><span class="p">}</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s">"{</span><span class="se">\"</span><span class="s">timeseries</span><span class="se">\"</span><span class="s">: {</span><span class="se">\"</span><span class="s">2001</span><span class="se">\"</span><span class="s">: 8523609.893269539, </span><span class="se">\"</span><span class="s">2002</span><span class="se">\"</span><span class="s">: 9219075.336818695, </span><span class="se">\"</span><span class="s">2003</span><span class="se">\"</span><span class="s">: 5745394.048210621, </span><span class="se">\"</span><span class="s">2004</span><span class="se">\"</span><span class="s">: 16352804.901271343, </span><span class="se">\"</span><span class="s">2005</span><span class="se">\"</span><span class="s">: 11950375.210030556, </span><span class="se">\"</span><span class="s">2006</span><span class="se">\"</span><span class="s">: 18535092.244664192, </span><span class="se">\"</span><span class="s">2007</span><span class="se">\"</span><span class="s">: 15964553.06836462, </span><span class="se">\"</span><span class="s">2008</span><span class="se">\"</span><span class="s">: 12015146.018202782, </span><span class="se">\"</span><span class="s">2009</span><span class="se">\"</span><span class="s">: 17515508.700252533, </span><span class="se">\"</span><span class="s">2010</span><span class="se">\"</span><span class="s">: 14973976.22736454, </span><span class="se">\"</span><span class="s">2011</span><span class="se">\"</span><span class="s">: 10555302.132576942, </span><span class="se">\"</span><span class="s">2012</span><span class="se">\"</span><span class="s">: 19785808.554305553, </span><span class="se">\"</span><span class="s">2013</span><span class="se">\"</span><span class="s">: 15784503.92861414, </span><span class="se">\"</span><span class="s">2014</span><span class="se">\"</span><span class="s">: 18598649.662708282, </span><span class="se">\"</span><span class="s">2015</span><span class="se">\"</span><span class="s">: 16366608.645088673, </span><span class="se">\"</span><span class="s">2016</span><span class="se">\"</span><span class="s">: 26919829.052940845, </span><span class="se">\"</span><span class="s">2017</span><span class="se">\"</span><span class="s">: 24389565.014420033, </span><span class="se">\"</span><span class="s">2018</span><span class="se">\"</span><span class="s">: 31650039.900456905}}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
    <span class="s">'cache-control'</span><span class="p">:</span> <span class="s">"no-cache"</span>
    <span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">querystring</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre>
<p>Example response:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"anomaly"</span><span class="p">:</span><span class="w"> </span><span class="mf">13226686.577202797</span><span class="p">,</span><span class="w">
      </span><span class="s2">"anomaly_uncertainty"</span><span class="p">:</span><span class="w"> </span><span class="mf">6605963.307585477</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bin_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Increase of 1.3e+07 over observation period has an associated p-value of 0.001</span><span class="se">\u</span><span class="s2">00b1 1.000 0.948."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"lower_p"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9480426688037374</span><span class="p">,</span><span class="w">
      </span><span class="s2">"mc_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"p"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9994235963381208</span><span class="p">,</span><span class="w">
      </span><span class="s2">"upper_p"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9999994544351509</span><span class="p">,</span><span class="w">
      </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mc_timeseries_analysis"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="geostore">Geostore</h1>

<h2 id="what-is-geostore">What is Geostore?</h2>

<p>Geostore is a geojson database. You can save your geojson or obtain geojson by country, region, Protected areas, etc.</p>

<p>Geostore object contains the following fields:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td style="text-align: center">Id of the geostore</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with the geometry</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>hash</td>
<td style="text-align: center">MD5 hash generated from geojson. Is the same that the id</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>provider</td>
<td style="text-align: center">This field should be completed if the geostore was created from a provider</td>
<td style="text-align: right">Object</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. It is possible use AND &amp; OR conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
</tr>
<tr>
<td>areaHa</td>
<td style="text-align: center">Area in Hectares of the geojson</td>
<td style="text-align: right">Number</td>
</tr>
<tr>
<td>bbox</td>
<td style="text-align: center">Bounding box of the geojson</td>
<td style="text-align: right">Array</td>
</tr>
</tbody></table>

<aside class="notice">
Remember  All endpoint of geostore don&rsquo;t need that you are authenticated.
</aside>

<h2 id="create-geostore">Create Geostore</h2>

<p>You can create a geostore in 4 different ways:</p>

<h3 id="with-a-geojson">With a Geojson</h3>

<p>If you have your own geojson, you can save it in geostore. To create the geostore, you need to define all the required fields in the request body. The fields that compose a geostore are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>geojson</td>
<td style="text-align: center">Geojson with your geometry</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To create a Geostore, you have to do a POST query with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson": &lt;yourGeoJSONObject&gt;
  }'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
   "geojson":{
      "type":"FeatureCollection",
      "features":[
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"LineString",
               "coordinates":[
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ],
                  [
                     -3.995418548583985,
                     41.03767166215326
                  ],
                  [
                     -3.9842605590820312,
                     41.03844854003296
                  ],
                  [
                     -3.9844322204589844,
                     41.04589315472392
                  ],
                  [
                     -3.9942169189453125,
                     41.044922165782175
                  ]
               ]
            }
         },
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"Polygon",
               "coordinates":[
                  [
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ]
                  ]
               ]
            }
         }
      ]
   }
}'</span>
</code></pre>
<p>The response will be 200 if the geostore saves correctly and returns the geostore object with all information:</p>

<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"geojson"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"features"</span><span class="p">:[</span><span class="w">
               </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"geometry"</span><span class="p">:{</span><span class="w">
                     </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Polygon"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"coordinates"</span><span class="p">:[</span><span class="w">
                        </span><span class="p">[</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">41.30257109430557</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">],</span><span class="w">
                           </span><span class="p">[</span><span class="w">
                              </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
                              </span><span class="mf">40.84706035607122</span><span class="w">
                           </span><span class="p">]</span><span class="w">
                        </span><span class="p">]</span><span class="w">
                     </span><span class="p">]</span><span class="w">
                  </span><span class="p">}</span><span class="w">
               </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"crs"</span><span class="p">:{</span><span class="w">

            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"FeatureCollection"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"hash"</span><span class="p">:</span><span class="s2">"c9bacccfb9c3fe225dc67545bb93a5cb"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"provider"</span><span class="p">:{</span><span class="w">

         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="mf">397372.34122605197</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bbox"</span><span class="p">:[</span><span class="w">
            </span><span class="mf">-4.4549560546875</span><span class="p">,</span><span class="w">
            </span><span class="mf">40.84706035607122</span><span class="p">,</span><span class="w">
            </span><span class="mf">-3.5211181640624996</span><span class="p">,</span><span class="w">
            </span><span class="mf">41.30257109430557</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country">From country</h3>

<p>If you need obtain the geostore of a country, you can obtain it with the ISO3 code in the Geostore API.</p>

<p><code class="prettyprint">GET https://api.skydipper.com/v1/geostore/admin/&lt;ISO3&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/admin/&lt;ISO3&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Spain
<code class="prettyprint">shell
curl -X GET https://api.skydipper.com/v1/geostore/admin/ESP
</code></p>
</blockquote>

<h3 id="country-list">Country list</h3>

<p>A list of countries can be obtained from this endpoint.</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/admin/list
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35a6d982388ee5c4e141c2bceac3fb72"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ESP"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spain"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8f77fe62cf15d5098ba0ee11c5126aa6"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FRA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"France"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"geostoreId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1d568c183033da6c17cc28c4aecf1bcf"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"iso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cod"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Democratic Republic of the Congo"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="from-country-and-region">From country and region</h3>

<p>If you need obtain the geostore of a region in a country, you can obtain it with the ISO3 and region code:</p>

<p><code class="prettyprint">GET https://api.skydipper.com/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/admin/&lt;ISO3&gt;/&lt;regionCode&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of Madrid&rsquo;s Comunity in Spain</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/admin/ESP/8
</code></pre>
<h3 id="from-world-database-on-protected-areas-wdpa">From World Database on Protected Areas (wdpa)</h3>

<p>Is possible obtain the geostore of a World Database on Protected Areas of the world. You only need the id of the protected area (WDPA).
<a href="https://www.protectedplanet.net/">World Database on Protected Areas web</a></p>

<p><code class="prettyprint">GET https://api.skydipper.com/v1/geostore/wdpa/&lt;wdpaId&gt;</code></p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/wdpa/&lt;wdpaId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining the geostore of &lsquo;Sierra de Guadarrama&rsquo; protected area</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/wdpa/555538160
</code></pre>
<h3 id="from-carto">From Carto</h3>

<p>If your geojson is in carto table, is possible import this geojson in geostore.
To import the geojson in geostore, you need to define all of the required fields in the request body. The fields that compose a import are:</p>

<table><thead>
<tr>
<th>Field</th>
<th style="text-align: center">Description</th>
<th style="text-align: right">Type</th>
<th>Values</th>
<th style="text-align: right">Required</th>
</tr>
</thead><tbody>
<tr>
<td>provider</td>
<td style="text-align: center">Provider of data</td>
<td style="text-align: right">Object</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; type</td>
<td style="text-align: center">Provider type</td>
<td style="text-align: right">Text</td>
<td>carto</td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; table</td>
<td style="text-align: center">Table name</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; user</td>
<td style="text-align: center">User of the account</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
<tr>
<td>&ndash; filter</td>
<td style="text-align: center">Conditions to obtain the geojson. Is possible put and and or conditions. This conditions must only return one row.</td>
<td style="text-align: right">Text</td>
<td></td>
<td style="text-align: right">Yes</td>
</tr>
</tbody></table>

<blockquote>
<p>To import a Geostore, you have to do a POST with the following body:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": &lt;tableName&gt;,
        "user": &lt;userName&gt;,
        "filter": &lt;conditions&gt;
    }
}'</span>
</code></pre>
<blockquote>
<p>Real example</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.skydipper.com/v1/geostore <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "provider":{
        "type": "carto",
        "table": "gfw_mining",
        "user": "wri-01",
        "filter": "cartodb_id=573"
    }
}'</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="obtain-a-geostore">Obtain a Geostore</h2>

<p>To obtain a geostore, you only need the id of the Geostore. You can perform a GET request for the geostore with its id.</p>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/&lt;geostoreId&gt;
</code></pre>
<blockquote>
<p>Real example obtaining one geostore</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET https://api.skydipper.com/v1/geostore/use/logging/26f8975c4c647c19a2edaa11f23880a2
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"geoStore"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"geojson"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Feature"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"geometry"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MultiPolygon"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">[</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.654348341203</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100850695703</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6543473339623</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814691125096</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="p">[</span><span class="w">
                      </span><span class="mf">-74.0957370284411</span><span class="p">,</span><span class="w">
                      </span><span class="mf">10.6814701233475</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                  </span><span class="p">]</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"crs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FeatureCollection"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26f8975c4c647c19a2edaa11f23880a2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cartodb_id=573"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wri-01"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gfw_mining"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carto"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"areaHa"</span><span class="p">:</span><span class="w"> </span><span class="mf">471.001953054716</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bbox"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mf">-74.1100876551212</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6543473339623</span><span class="p">,</span><span class="w">
        </span><span class="mf">-74.0957357154309</span><span class="p">,</span><span class="w">
        </span><span class="mf">10.6814701233475</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="geodescriber">Geodescriber</h1>

<p>Geodescriber returns a text description of any Geostore or valid geojson area, in any langunage, dynamically.
Responses from Geodescriber have been tailored to different purposes. The (optional) argument <code class="prettyprint">app</code> controls which flavour
description you will return.</p>

<p>The code for Geodescriber is <a href="https://github.com/Skydipper/Geodescriber">hosted on Github</a>.</p>

<h2 id="call-geodescriber-with-a-geostore-id">Call Geodescriber with a Geostore ID</h2>

<p>You can return a response from the Geodescriber by providing a <code class="prettyprint">geostore</code> paramter in your <em>GET</em> request.
You can change the language of the response via the <code class="prettyprint">lang</code> flag, using the <a href="https://www.sitepoint.com/iso-2-letter-language-codes/">ISO-2 codes</a>.</p>
<pre class="highlight shell"><code>curl --location --request GET <span class="s1">'https://api.skydipper.com/api/v1/geodescriber?geostore=&lt;ID_HASH&gt;&amp;template=False&amp;app=skydipper&amp;lang=en'</span>
</code></pre>
<blockquote>
<p>Example Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"The region's habitat is comprised of Cantabrian mixed forests. This region has no Intact Forest. The area has a predominantly warm and temperate climate with dry summers. It is part of the Temperate Broadleaf and Mixed Forests biome. The location is mostly land area with a large proportion of marine area. Area of 12,387km located in a predominanty lowland area."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description_params"</span><span class="p">:{},</span><span class="w">
      </span><span class="s2">"lang"</span><span class="p">:</span><span class="s2">"en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"stats"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"biome"</span><span class="p">:{</span><span class="s2">"4"</span><span class="p">:</span><span class="mf">1082227.4941176388</span><span class="p">},</span><span class="w">
         </span><span class="s2">"ecoregion"</span><span class="p">:{</span><span class="s2">"648"</span><span class="p">:</span><span class="mf">1082227.4941176388</span><span class="p">},</span><span class="w">
         </span><span class="s2">"intact2016"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1666560.2431372453</span><span class="p">},</span><span class="w">
         </span><span class="s2">"isMountain"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1603363.7882352876</span><span class="p">,</span><span class="w">
                       </span><span class="s2">"1"</span><span class="p">:</span><span class="mf">63196.454901960824</span><span class="p">},</span><span class="w">
         </span><span class="s2">"koppen"</span><span class="p">:{</span><span class="s2">"32"</span><span class="p">:</span><span class="mf">222131.647058824</span><span class="p">,</span><span class="w">
                   </span><span class="s2">"35"</span><span class="p">:</span><span class="mf">1222652.1764705782</span><span class="p">},</span><span class="w">
         </span><span class="s2">"seaLandFreshwater"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1094287.9294117563</span><span class="p">,</span><span class="w">
                              </span><span class="s2">"1"</span><span class="p">:</span><span class="mf">572272.3137254902</span><span class="p">}</span><span class="w">
               </span><span class="p">},</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="s2">"Area in Galicia, Spain"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title_params"</span><span class="p">:{}</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="geodescriber-from-valid-geojson">Geodescriber from valid GeoJSON</h2>

<p>If the geometry does not correspond to a Geostore object, and you do not wish to create one, you can post a valid
geojson directly to the Geodescriber service and return a response.</p>
<pre class="highlight shell"><code>curl --location --request POST <span class="s1">'https://api.skydipper.com/v1/geodescriber/geom?lang=en&amp;app=skydipper'</span> <span class="se">\</span>
--header <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
--data-raw <span class="s1">'{"geojson":{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"type":"Polygon","coordinates":[[[-8.749999866114031,43.86562279054269],[-8.500000104532665,43.86562279054269],[-8.2500003429513,43.86562279054269],[-8.000000581369934,43.86562279054269],[-8.000000581369934,42.49423975448128],[-8.2500003429513,42.49423975448128],[-8.500000104532665,42.49423975448128],[-8.749999866114031,42.49423975448128],[-8.999999627695365,42.49423975448128],[-8.999999627695365,43.86562279054269],[-8.749999866114031,43.86562279054269]]]}}]}}'</span>

</code></pre>
<blockquote>
<p>Example Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"The region's habitat is comprised of Cantabrian mixed forests. This region has no Intact Forest. The area has a predominantly warm and temperate climate with dry summers. It is part of the Temperate Broadleaf and Mixed Forests biome. The location is mostly land area with a large proportion of marine area. Area of 12,387km located in a predominanty lowland area."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description_params"</span><span class="p">:{},</span><span class="w">
      </span><span class="s2">"lang"</span><span class="p">:</span><span class="s2">"en"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"stats"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"biome"</span><span class="p">:{</span><span class="s2">"4"</span><span class="p">:</span><span class="mf">1082227.4941176388</span><span class="p">},</span><span class="w">
         </span><span class="s2">"ecoregion"</span><span class="p">:{</span><span class="s2">"648"</span><span class="p">:</span><span class="mf">1082227.4941176388</span><span class="p">},</span><span class="w">
         </span><span class="s2">"intact2016"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1666560.2431372453</span><span class="p">},</span><span class="w">
         </span><span class="s2">"isMountain"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1603363.7882352876</span><span class="p">,</span><span class="w">
                       </span><span class="s2">"1"</span><span class="p">:</span><span class="mf">63196.454901960824</span><span class="p">},</span><span class="w">
         </span><span class="s2">"koppen"</span><span class="p">:{</span><span class="s2">"32"</span><span class="p">:</span><span class="mf">222131.647058824</span><span class="p">,</span><span class="w">
                   </span><span class="s2">"35"</span><span class="p">:</span><span class="mf">1222652.1764705782</span><span class="p">},</span><span class="w">
         </span><span class="s2">"seaLandFreshwater"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="mf">1094287.9294117563</span><span class="p">,</span><span class="w">
                              </span><span class="s2">"1"</span><span class="p">:</span><span class="mf">572272.3137254902</span><span class="p">}</span><span class="w">
               </span><span class="p">},</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="s2">"Area in Galicia, Spain"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title_params"</span><span class="p">:{}</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
          <h1 id="geodoctor">GeoDoctor</h1>

<h2 id="what-is-the-geodoctor-service">What is the GeoDoctor service?</h2>

<p>GeoDoctor is a service to receive geospatial datafiles of various kinds, extract shapes, repair and simplify those shapes.
The service responds with a valid geojson object that can be consumed by other Skydipper services such as Geostore.</p>

<p>File conversion is done with GDAL OGR2OGR), and
optional cleaning and simplification is done using the <a href="https://github.com/mbloch/mapshaper/wiki/Command-Reference">visvalingam method</a>,
preserving features with Mapshaper.</p>

<h3 id="an-example-with-geosjon">An example with GEOSJON</h3>

<p>Given an input file which contains:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'FeatureCollection'</span><span class="p">,</span><span class="w">
 </span><span class="err">'features'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Feature'</span><span class="p">,</span><span class="w">
   </span><span class="err">'properties'</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
   </span><span class="err">'geometry'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Polygon'</span><span class="p">,</span><span class="w">
    </span><span class="err">'coordinates'</span><span class="p">:</span><span class="w"> </span><span class="p">[[[</span><span class="mf">-8.690185546875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.8334428466495</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.140625</span><span class="p">,</span><span class="w"> </span><span class="mf">32.648625783736726</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.052734375</span><span class="p">,</span><span class="w"> </span><span class="mf">32.44488496716713</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.865966796875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.27784451498272</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.8330078125</span><span class="p">,</span><span class="w"> </span><span class="mf">32.16631295696736</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.865966796875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.008075959291055</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.98681640625</span><span class="p">,</span><span class="w"> </span><span class="mf">31.970803930433096</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.33837890625</span><span class="p">,</span><span class="w"> </span><span class="mf">31.93351676190369</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.64599609375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.672083485607402</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.755859375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.23159167205059</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.481201171875</span><span class="p">,</span><span class="w"> </span><span class="mf">31.005862904624205</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.041748046875</span><span class="p">,</span><span class="w"> </span><span class="mf">30.552800413453546</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.0966796875</span><span class="p">,</span><span class="w"> </span><span class="mf">30.173624550358536</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-9.239501953125</span><span class="p">,</span><span class="w"> </span><span class="mf">30.002516938570686</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.3056640625</span><span class="p">,</span><span class="w"> </span><span class="mf">29.707139348134145</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.965087890625</span><span class="p">,</span><span class="w"> </span><span class="mf">29.964452850852005</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.921142578125</span><span class="p">,</span><span class="w"> </span><span class="mf">30.259067203213018</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.052978515625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.4297295750316</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.3056640625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.524413269923986</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.4375</span><span class="p">,</span><span class="w"> </span><span class="mf">30.609549797190844</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.3056640625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.798474179567823</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.140869140625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.713503990354965</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.074951171875</span><span class="p">,</span><span class="w"> </span><span class="mf">30.675715404167743</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.987060546875</span><span class="p">,</span><span class="w"> </span><span class="mf">30.62845887475364</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.91015625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.5717205651999</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.822265625000001</span><span class="p">,</span><span class="w"> </span><span class="mf">30.543338954230222</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.701416015625001</span><span class="p">,</span><span class="w"> </span><span class="mf">30.543338954230222</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.679443359375</span><span class="p">,</span><span class="w"> </span><span class="mf">30.6662659463233</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.811279296874999</span><span class="p">,</span><span class="w"> </span><span class="mf">30.80791068136646</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.965087890625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.883369321692268</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.052978515625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.92107637538488</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.19580078125</span><span class="p">,</span><span class="w"> </span><span class="mf">30.95876857077987</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.28369140625</span><span class="p">,</span><span class="w"> </span><span class="mf">30.987027960280326</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.382568359375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.071755902820133</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.349609375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.22219703210317</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.06396484375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.287939892641734</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.833251953125</span><span class="p">,</span><span class="w"> </span><span class="mf">31.297327991404266</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-6.723632812499999</span><span class="p">,</span><span class="w"> </span><span class="mf">32.26855544621476</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-7.822265625000001</span><span class="p">,</span><span class="w"> </span><span class="mf">32.537551746769</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.10791015625</span><span class="p">,</span><span class="w"> </span><span class="mf">31.970803930433096</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.646240234375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.96148355726853</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.37158203125</span><span class="p">,</span><span class="w"> </span><span class="mf">32.194208672875384</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.118896484375</span><span class="p">,</span><span class="w"> </span><span class="mf">32.676372772089834</span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="mf">-8.690185546875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.8334428466495</span><span class="p">]]]}}]}</span><span class="w">
</span></code></pre>
<p>From this file you can call the GeoDoctor service like this:</p>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/geodoctor/convert"</span>
<span class="n">querystring</span> <span class="o">=</span> <span class="p">{</span><span class="s">"simplify"</span><span class="p">:</span><span class="s">"10"</span><span class="p">,</span> <span class="s">"clean"</span><span class="p">:</span><span class="s">"true"</span><span class="p">}</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'file'</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s">'&lt;path_to_your_file&gt;/&lt;your_file.geosjon&gt;'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">),</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">"application/json, text/pain, */*"</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">querystring</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre>
<p>Which will result in a response like:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="err">'data'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'geoJSON'</span><span class="p">,</span><span class="w">
  </span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="err">'undefined'</span><span class="p">,</span><span class="w">
  </span><span class="err">'attributes'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'FeatureCollection'</span><span class="p">,</span><span class="w">
   </span><span class="err">'features'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Feature'</span><span class="p">,</span><span class="w">
     </span><span class="err">'properties'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'__id'</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">
     </span><span class="err">'geometry'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Polygon'</span><span class="p">,</span><span class="w">
      </span><span class="err">'coordinates'</span><span class="p">:</span><span class="w"> </span><span class="p">[[[</span><span class="mf">-8.690185546875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.8334428466495</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-6.723632812499999</span><span class="p">,</span><span class="w"> </span><span class="mf">32.26855544621476</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-7.833251953125</span><span class="p">,</span><span class="w"> </span><span class="mf">31.297327991404266</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-8.3056640625</span><span class="p">,</span><span class="w"> </span><span class="mf">29.707139348134145</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-9.755859375</span><span class="p">,</span><span class="w"> </span><span class="mf">31.23159167205059</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-8.690185546875</span><span class="p">,</span><span class="w"> </span><span class="mf">32.8334428466495</span><span class="p">]]]}}]}}}</span><span class="w">
</span></code></pre>
<p>Note the simplification of <code class="prettyprint">simplify: 10</code> means that the shape has been simplified by 90%.</p>

<h3 id="example-with-well-known-text">Example with Well-Known-text</h3>

<p>You can upload Well-Known-Text format also, e.g. given a sample file with the contents:</p>
<pre class="highlight plaintext"><code>index, geom,
1,"POLYGON ((-3.6694335937500004 40.896905775860006, -3.14208984375 40.58058466412761, -2.8125 40.81380923056958, -2.96630859375 41.16211393939692, -3.6035156249999996 41.44272637767212, -4.306640625 41.52502957323801, -5.053710937499999 41.47566020027821, -5.47119140625 41.32732632036622, -5.80078125 41.0130657870063, -5.91064453125 40.54720023441049, -5.888671875 40.06125658140474, -5.64697265625 39.690280594818034, -5.185546875 39.41922073655956, -4.32861328125 39.30029918615029, -3.427734375 39.30029918615029, -3.01025390625 39.554883059924016, -3.01025390625 39.87601941962116, -2.548828125 39.90973623453719, -2.57080078125 40.195659093364654, -3.97705078125 40.212440718286466, -3.97705078125 39.9434364619742, -3.5595703125 39.926588421909436, -3.5815429687499996 39.757879992021756, -4.50439453125 39.690280594818034, -5.053710937499999 39.8928799002948, -5.20751953125 40.07807142745009, -5.295410156249999 40.39676430557203, -5.3173828125 40.84706035607122, -4.89990234375 41.02964338716638, -4.4384765625 41.062786068733026, -3.80126953125 41.062786068733026, -3.6694335937500004 40.896905775860006))"
</code></pre>
<p>You can use that file as an input to the service like so:</p>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/geodoctor/convert"</span>
<span class="n">querystring</span> <span class="o">=</span> <span class="p">{</span><span class="s">"simplify"</span><span class="p">:</span><span class="s">"90"</span><span class="p">,</span> <span class="s">"clean"</span><span class="p">:</span><span class="s">"true"</span><span class="p">}</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'file'</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s">'&lt;path_to_your_file&gt;/&lt;your_file.csv&gt;'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">),</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">"application/json, text/pain, */*"</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">querystring</span><span class="p">)</span>
</code></pre>
<p>Gives a response of:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="err">'geojson'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'FeatureCollection'</span><span class="p">,</span><span class="w">
  </span><span class="err">'features'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Feature'</span><span class="p">,</span><span class="w">
    </span><span class="err">'properties'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'index'</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="mi">1</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">'field_</span><span class="mi">3</span><span class="err">'</span><span class="p">:</span><span class="w"> </span><span class="err">None</span><span class="p">,</span><span class="w"> </span><span class="err">'__id'</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">
    </span><span class="err">'geometry'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Polygon'</span><span class="p">,</span><span class="w">
     </span><span class="err">'coordinates'</span><span class="p">:</span><span class="w"> </span><span class="p">[[[</span><span class="mf">-3.66943359375</span><span class="p">,</span><span class="w"> </span><span class="mf">40.896905775860006</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.80126953125</span><span class="p">,</span><span class="w"> </span><span class="mf">41.062786068733026</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-4.89990234375</span><span class="p">,</span><span class="w"> </span><span class="mf">41.02964338716638</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.3173828125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.84706035607122</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.20751953125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.07807142745009</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.053710937499999</span><span class="p">,</span><span class="w"> </span><span class="mf">39.8928799002948</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-4.50439453125</span><span class="p">,</span><span class="w"> </span><span class="mf">39.690280594818034</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.58154296875</span><span class="p">,</span><span class="w"> </span><span class="mf">39.757879992021756</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.5595703125</span><span class="p">,</span><span class="w"> </span><span class="mf">39.926588421909436</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.97705078125</span><span class="p">,</span><span class="w"> </span><span class="mf">39.9434364619742</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.97705078125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.212440718286466</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-2.57080078125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.195659093364654</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-2.548828125</span><span class="p">,</span><span class="w"> </span><span class="mf">39.90973623453719</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.01025390625</span><span class="p">,</span><span class="w"> </span><span class="mf">39.87601941962116</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.01025390625</span><span class="p">,</span><span class="w"> </span><span class="mf">39.554883059924016</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.427734375</span><span class="p">,</span><span class="w"> </span><span class="mf">39.30029918615029</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-4.32861328125</span><span class="p">,</span><span class="w"> </span><span class="mf">39.30029918615029</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.185546875</span><span class="p">,</span><span class="w"> </span><span class="mf">39.41922073655956</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.64697265625</span><span class="p">,</span><span class="w"> </span><span class="mf">39.690280594818034</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.888671875</span><span class="p">,</span><span class="w"> </span><span class="mf">40.06125658140474</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.91064453125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.54720023441049</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.80078125</span><span class="p">,</span><span class="w"> </span><span class="mf">41.0130657870063</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.47119140625</span><span class="p">,</span><span class="w"> </span><span class="mf">41.32732632036622</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-5.053710937499999</span><span class="p">,</span><span class="w"> </span><span class="mf">41.47566020027821</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-4.306640625</span><span class="p">,</span><span class="w"> </span><span class="mf">41.52502957323801</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.603515625</span><span class="p">,</span><span class="w"> </span><span class="mf">41.44272637767212</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-2.96630859375</span><span class="p">,</span><span class="w"> </span><span class="mf">41.16211393939692</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-2.8125</span><span class="p">,</span><span class="w"> </span><span class="mf">40.81380923056958</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.14208984375</span><span class="p">,</span><span class="w"> </span><span class="mf">40.58058466412761</span><span class="p">],</span><span class="w">
       </span><span class="p">[</span><span class="mf">-3.66943359375</span><span class="p">,</span><span class="w"> </span><span class="mf">40.896905775860006</span><span class="p">]]]}}],</span><span class="w">
  </span><span class="err">'crs'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'name'</span><span class="p">,</span><span class="w">
   </span><span class="err">'properties'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'name'</span><span class="p">:</span><span class="w"> </span><span class="err">'urn</span><span class="p">:</span><span class="err">ogc</span><span class="p">:</span><span class="err">def</span><span class="p">:</span><span class="err">crs</span><span class="p">:</span><span class="err">OGC</span><span class="p">:</span><span class="mf">1.3</span><span class="p">:</span><span class="err">CRS</span><span class="mi">84</span><span class="err">'</span><span class="p">}}}}</span><span class="w">
</span></code></pre>
          <h1 id="query">Query</h1>

<p>In order to retrieve data from the datasets it is possible to send queries to the API using the SQL or Feature Service languages.</p>

<p>Two different endpoints are provided (under the dataset path and a generic one) and the sql query can be provided via query parameters or in the body of a POST request.</p>
<pre class="highlight shell"><code>curl -i -H <span class="s1">'Authorization: Bearer your-token&gt;'</span> -H <span class="s1">'Content-Type: application/json'</span> -XPOST <span class="s1">'http://api.skydipper.com/v1/query/&lt;dataset_id&gt;/'</span> -d <span class="s1">'{
    "sql": "SELECT * FROM &lt;dataset_id&gt; limit 10"
}
'</span>
</code></pre><pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.skydipper.com/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;
</code></pre>
<aside class="notice">
While we aim to make our query interface as broad and transparent as possible, some of the querying options described 
below will not be available for specific dataset providers, depending on this API&rsquo;s implementation or limitations on the
actual data provider&rsquo;s side.
</aside>

<h2 id="select-clause">Select clause</h2>

<p>The <code class="prettyprint">SELECT</code> part of the queries supports naming columns, <strong>alias</strong>, <strong>math operations</strong>, <strong>DISTINCT</strong>, <strong>COUNT</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">as</span> <span class="n">minimum</span> <span class="k">FROM</span> <span class="k">table</span>

<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="from-clause">From clause</h2>

<p>It is possible to refer to a dataset by using its <strong>table name</strong>, <strong>slug</strong> or <strong>id</strong>. </p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">tableName</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">slug</span><span class="o">&gt;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dataset</span><span class="p">.</span><span class="n">id</span><span class="o">&gt;</span>
</code></pre>
<h2 id="where-clause">Where clause</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">text</span> <span class="k">like</span> <span class="s1">'a%'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">st_intersects</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="s1">'{}'</span><span class="p">),</span> <span class="mi">4326</span><span class="p">),</span> <span class="n">the_geom</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="k">data</span> <span class="k">BETWEEN</span> <span class="mi">1</span> <span class="k">AND</span> <span class="mi">3</span>
</code></pre>
<h2 id="group-by-clause">Group by clause</h2>

<p>It is possible to group results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong>.
Special grouping operations are available for document-type datasets (CSV and JSON) - see <a href="https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql">this link</a> for more info.</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">columnOne</span><span class="p">,</span> <span class="n">columnTwo</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom_point</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">a</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ST_GeoHash</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</code></pre><pre class="highlight sql"><code><span class="cm">/* Only supported in document-type datasets - see https://github.com/NLPchina/elasticsearch-sql/tree/5.5.2.0#beyond-sql for full details */</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">tablename</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">range</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span> 
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_histogram</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'interval'</span><span class="o">=</span><span class="s1">'1d'</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">online</span> <span class="k">FROM</span> <span class="n">online</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">date_range</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'insert_time'</span><span class="p">,</span><span class="s1">'format'</span><span class="o">=</span><span class="s1">'yyyy-MM-dd'</span> <span class="p">,</span><span class="s1">'2014-08-18'</span><span class="p">,</span><span class="s1">'2014-08-17'</span><span class="p">,</span><span class="s1">'now-8d'</span><span class="p">,</span><span class="s1">'now-7d'</span><span class="p">,</span><span class="s1">'now-6d'</span><span class="p">,</span><span class="s1">'now'</span><span class="p">)</span>
</code></pre>
<h2 id="order-by-clause">Order by clause</h2>

<p>It is possible to order results by <strong>column name</strong>, <strong>SQL functions</strong> and <strong>PostGIS functions</strong></p>

<h2 id="limit-and-offset-clause">Limit and offset clause</h2>

<p>You can specify <code class="prettyprint">limit</code> and <code class="prettyprint">offset</code> clauses</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">limit</span><span class="o">=</span><span class="mi">20</span> <span class="k">offset</span> <span class="mi">10</span>
</code></pre>
<h2 id="raster-queries-available">Raster queries available</h2>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="n">ST_METADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_BANDMETADATA</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="n">occurrence</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_SUMMARYSTATS</span><span class="p">()</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_HISTOGRAM</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
<span class="k">SELECT</span> <span class="n">ST_valueCount</span><span class="p">(</span><span class="n">rast</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span>
</code></pre>
<h2 id="freeze-query">Freeze query</h2>

<p>It is possible generate a json file in a bucket of the sql result. You only need send a query param freeze with value true and you will obtain the url of the json file.</p>

<aside class="notice">
    This is an authenticated feature!
</aside>
<pre class="highlight shell"><code>curl -i -XGET http<span class="se">\:</span>//api.skydipper.com/v1/query<span class="se">\?</span>sql<span class="se">\=</span>SELECT<span class="se">\ \*\ </span>from<span class="se">\ </span>&lt;dataset.slug&gt;&amp;freeze<span class="o">=</span><span class="nb">true</span>
</code></pre>
<h2 id="download">Download</h2>

<p>You can download the result of a query using the <code class="prettyprint">download</code> endpoint. </p>

<aside class="warning">
    <ul>
    This endpoint is not neccesarily supported for all dataset providers. The following dataset connector provide support for downloads:
        <li>Google Earth Engine</li>
        <li>Carto</li>
        <li>ArcGIS FeatureService</li>
    </ul>
</aside>
<pre class="highlight shell"><code><span class="c"># The id of the dataset is part of the URL</span>
curl -XGET https://api.skydipper.com/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;

<span class="c"># The id of the dataset is in the FROM clause</span>
curl -XGET https://api.skydipper.com/v1/download?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.id&gt;
</code></pre>
<p>There are two ways to call it:</p>

<ul>
<li>you can either specify the id of the dataset in the URL</li>
<li>or you can pass it as part of the SQL query (in the FROM clause)</li>
</ul>

<p>You can also specify which file type you want to download (JSON or CSV), except for Google Earth Engine datasets (only JSON).</p>

<aside class="notice">
    By default, the API will return a CSV file (JSON file for Google Earth Engine).
</aside>
<pre class="highlight shell"><code><span class="c"># The format is explicitly set</span>
curl -XGET https://api.skydipper.com/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>json
curl -XGET https://api.skydipper.com/v1/download/&lt;dataset.id&gt;?sql<span class="o">=</span>SELECT <span class="k">*</span> from &lt;dataset.tableName&gt;&amp;format<span class="o">=</span>csv
</code></pre>
          <h1 id="recentimagery">RecentImagery</h1>

<p>Service for identifying satellite imagery tiles from Landsat and Sentinel-2.
You are able to search for a location, and time range, and set band visulisation parameters.</p>

<h2 id="return-a-list-of-all-intersecting-satellite-images">Return a list of all intersecting satellite images</h2>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="n">f</span><span class="s">"http://api.skydipper.com/v1/recent-imagery"</span>
<span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">"lat"</span><span class="p">:</span><span class="mf">28.399391877577933</span><span class="p">,</span>
        <span class="s">"lon"</span><span class="p">:</span><span class="o">-</span><span class="mf">16.493425662438167</span><span class="p">,</span>
        <span class="s">"start"</span><span class="p">:</span><span class="s">"2019-11-1"</span><span class="p">,</span>
        <span class="s">"end"</span><span class="p">:</span><span class="s">"2019-11-22"</span><span class="p">,</span>
        <span class="s">"bands"</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre>
<p>Returns a response like:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="err">'data'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="err">None</span><span class="p">,</span><span class="w">
  </span><span class="err">'tiles'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'attributes'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'bbox'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'geometry'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'coordinates'</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mf">-15.92558389724579</span><span class="p">,</span><span class="w">
         </span><span class="mf">28.925190549257714</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.92559671449868</span><span class="p">,</span><span class="w"> </span><span class="mf">28.925191163600214</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.051433713664156</span><span class="p">,</span><span class="w"> </span><span class="mf">28.91274387174152</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.051480391568088</span><span class="p">,</span><span class="w"> </span><span class="mf">28.912706620290745</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.051531935518994</span><span class="p">,</span><span class="w"> </span><span class="mf">28.912674682697084</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.05153490920881</span><span class="p">,</span><span class="w"> </span><span class="mf">28.91265990682834</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.041910802259004</span><span class="p">,</span><span class="w"> </span><span class="mf">28.41750963441286</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.032527124641494</span><span class="p">,</span><span class="w"> </span><span class="mf">27.922327989157285</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.03248495569906</span><span class="p">,</span><span class="w"> </span><span class="mf">27.922287141116684</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.032448913873885</span><span class="p">,</span><span class="w"> </span><span class="mf">27.92224196307347</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-17.0324320643225</span><span class="p">,</span><span class="w"> </span><span class="mf">27.922239418847433</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.917013741784361</span><span class="p">,</span><span class="w"> </span><span class="mf">27.934185520299348</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.916967046088413</span><span class="p">,</span><span class="w"> </span><span class="mf">27.93422235347645</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.91691560017191</span><span class="p">,</span><span class="w"> </span><span class="mf">27.934253830965012</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.916912552853256</span><span class="p">,</span><span class="w"> </span><span class="mf">27.93426863344697</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.921148642190191</span><span class="p">,</span><span class="w"> </span><span class="mf">28.429707339526168</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.925493100926781</span><span class="p">,</span><span class="w"> </span><span class="mf">28.92510186499591</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.925535317176289</span><span class="p">,</span><span class="w"> </span><span class="mf">28.925143044864797</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.925571259256028</span><span class="p">,</span><span class="w"> </span><span class="mf">28.925188529207674</span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="mf">-15.92558389724579</span><span class="p">,</span><span class="w"> </span><span class="mf">28.925190549257714</span><span class="p">]],</span><span class="w">
       </span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'Polygon'</span><span class="p">}},</span><span class="w">
     </span><span class="err">'cloud_score'</span><span class="p">:</span><span class="w"> </span><span class="mf">57.3898</span><span class="p">,</span><span class="w">
     </span><span class="err">'date_time'</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="mi">2019-11-17</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">21</span><span class="err">Z'</span><span class="p">,</span><span class="w">
     </span><span class="err">'instrument'</span><span class="p">:</span><span class="w"> </span><span class="err">'Sentinel</span><span class="mi">-2</span><span class="err">A'</span><span class="p">,</span><span class="w">
     </span><span class="err">'source'</span><span class="p">:</span><span class="w"> </span><span class="err">'COPERNICUS/S</span><span class="mi">2</span><span class="err">/</span><span class="mi">20191117</span><span class="err">T</span><span class="mi">115221</span><span class="err">_</span><span class="mi">20191117</span><span class="err">T</span><span class="mi">115220</span><span class="err">_T</span><span class="mi">28</span><span class="err">RCS'</span><span class="p">,</span><span class="w">
     </span><span class="err">'thumbnail_url'</span><span class="p">:</span><span class="w"> </span><span class="err">None</span><span class="p">,</span><span class="w">
     </span><span class="err">'tile_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/map/</span><span class="mi">6</span><span class="err">c</span><span class="mi">4</span><span class="err">d</span><span class="mi">08</span><span class="err">f</span><span class="mi">0</span><span class="err">e</span><span class="mi">527</span><span class="err">f</span><span class="mi">62</span><span class="err">e</span><span class="mi">97</span><span class="err">d</span><span class="mi">85</span><span class="err">a</span><span class="mi">92</span><span class="err">c</span><span class="mi">5</span><span class="err">c</span><span class="mi">181</span><span class="err">bc/</span><span class="p">{</span><span class="err">z</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">x</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">y</span><span class="p">}</span><span class="err">?token=</span><span class="mi">733263</span><span class="err">c</span><span class="mi">1</span><span class="err">e</span><span class="mi">4925</span><span class="err">c</span><span class="mi">385702</span><span class="err">d</span><span class="mi">2</span><span class="err">a</span><span class="mi">18</span><span class="err">f</span><span class="mi">2</span><span class="err">e</span><span class="mi">39</span><span class="err">a</span><span class="mi">6</span><span class="err">'</span><span class="w">
     </span><span class="p">}}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="request-tiles">Request tiles</h2>

<p>You can use the response from the query to <code class="prettyprint">/recent-imagery</code> to make a further request to <code class="prettyprint">tiles</code> and <code class="prettyprint">thumbs</code> endpoints.</p>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">tiles_url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/recent-imagery/tiles"</span>
<span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s">"source_data"</span><span class="p">:</span> <span class="p">[{</span><span class="s">"source"</span><span class="p">:</span><span class="s">'COPERNICUS/S2/20191107T115221_20191107T115221_T28RCS'</span><span class="p">},{</span><span class="s">"source"</span><span class="p">:</span><span class="s">'LANDSAT/LC08/C01/T1_RT_TOA/LC08_207040_20191117'</span><span class="p">}],</span>
            <span class="s">"min"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">"max"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">"opacity"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s">"bands"</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">tiles_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre>
<p>Which will result in a response such as:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="err">'data'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'attributes'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'source_id'</span><span class="p">:</span><span class="w"> </span><span class="err">'COPERNICUS/S</span><span class="mi">2</span><span class="err">/</span><span class="mi">20191107</span><span class="err">T</span><span class="mi">115221</span><span class="err">_</span><span class="mi">20191107</span><span class="err">T</span><span class="mi">115221</span><span class="err">_T</span><span class="mi">28</span><span class="err">RCS'</span><span class="p">,</span><span class="w">
    </span><span class="err">'tile_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/map/d</span><span class="mi">58</span><span class="err">d</span><span class="mi">121</span><span class="err">e</span><span class="mi">0</span><span class="err">a</span><span class="mi">14</span><span class="err">ccf</span><span class="mi">17</span><span class="err">bb</span><span class="mi">3</span><span class="err">fa</span><span class="mi">08</span><span class="err">af</span><span class="mi">87</span><span class="err">bb</span><span class="mi">73</span><span class="err">/</span><span class="p">{</span><span class="err">z</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">x</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">y</span><span class="p">}</span><span class="err">?token=</span><span class="mi">3</span><span class="err">fb</span><span class="mi">09853</span><span class="err">e</span><span class="mi">976</span><span class="err">ad</span><span class="mi">45</span><span class="err">cfc</span><span class="mi">4</span><span class="err">b</span><span class="mi">3</span><span class="err">dc</span><span class="mi">267</span><span class="err">f</span><span class="mi">455</span><span class="err">a'</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="err">'source_id'</span><span class="p">:</span><span class="w"> </span><span class="err">'LANDSAT/LC</span><span class="mi">08</span><span class="err">/C</span><span class="mi">01</span><span class="err">/T</span><span class="mi">1</span><span class="err">_RT_TOA/LC</span><span class="mi">08</span><span class="err">_</span><span class="mi">207040</span><span class="err">_</span><span class="mi">20191117</span><span class="err">'</span><span class="p">,</span><span class="w">
    </span><span class="err">'tile_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/map/</span><span class="mi">277080042</span><span class="err">a</span><span class="mi">8</span><span class="err">a</span><span class="mi">4</span><span class="err">c</span><span class="mi">5481346</span><span class="err">a</span><span class="mi">3</span><span class="err">f</span><span class="mi">341</span><span class="err">ed</span><span class="mi">01</span><span class="err">a/</span><span class="p">{</span><span class="err">z</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">x</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">y</span><span class="p">}</span><span class="err">?token=</span><span class="mi">613</span><span class="err">fe</span><span class="mi">7</span><span class="err">ab</span><span class="mi">781</span><span class="err">cde</span><span class="mi">1</span><span class="err">fbca</span><span class="mi">1</span><span class="err">e</span><span class="mi">1</span><span class="err">b</span><span class="mi">242</span><span class="err">c</span><span class="mi">508</span><span class="err">aa'</span><span class="p">}],</span><span class="w">
  </span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="err">None</span><span class="p">,</span><span class="w">
  </span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'recentimages-tiles'</span><span class="p">}}</span><span class="w">
</span></code></pre>
<h2 id="request-thumbnails">Request thumbnails</h2>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">tiles_url</span> <span class="o">=</span> <span class="s">"http://api.skydipper.com/v1/recent-imagery/thumbs"</span>
<span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s">"source_data"</span><span class="p">:</span> <span class="p">[{</span><span class="s">"source"</span><span class="p">:</span><span class="s">'COPERNICUS/S2/20191107T115221_20191107T115221_T28RCS'</span><span class="p">},{</span><span class="s">'source'</span><span class="p">:</span> <span class="s">'COPERNICUS/S2/20191117T115221_20191117T115220_T28RCS'</span><span class="p">},</span> <span class="p">{</span><span class="s">"source"</span><span class="p">:</span><span class="s">'LANDSAT/LC08/C01/T1_RT_TOA/LC08_207040_20191117'</span><span class="p">}],</span>
            <span class="s">"min"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">"max"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">"opacity"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s">"bands"</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">tiles_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="err">'data'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">'attributes'</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="err">'source'</span><span class="p">:</span><span class="w"> </span><span class="err">'COPERNICUS/S</span><span class="mi">2</span><span class="err">/</span><span class="mi">20191107</span><span class="err">T</span><span class="mi">115221</span><span class="err">_</span><span class="mi">20191107</span><span class="err">T</span><span class="mi">115221</span><span class="err">_T</span><span class="mi">28</span><span class="err">RCS'</span><span class="p">,</span><span class="w">
    </span><span class="err">'thumbnail_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/api/thumb?thumbid=ba</span><span class="mi">7</span><span class="err">e</span><span class="mi">8</span><span class="err">eb</span><span class="mi">6</span><span class="err">d</span><span class="mi">9606</span><span class="err">ad</span><span class="mi">6191402148</span><span class="err">fc</span><span class="mi">2</span><span class="err">e</span><span class="mi">4</span><span class="err">dd&amp;token=d</span><span class="mi">732</span><span class="err">ad</span><span class="mi">356760313627096</span><span class="err">ed</span><span class="mi">9888944</span><span class="err">f</span><span class="mi">4</span><span class="err">'</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="err">'source'</span><span class="p">:</span><span class="w"> </span><span class="err">'COPERNICUS/S</span><span class="mi">2</span><span class="err">/</span><span class="mi">20191117</span><span class="err">T</span><span class="mi">115221</span><span class="err">_</span><span class="mi">20191117</span><span class="err">T</span><span class="mi">115220</span><span class="err">_T</span><span class="mi">28</span><span class="err">RCS'</span><span class="p">,</span><span class="w">
    </span><span class="err">'thumbnail_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/api/thumb?thumbid=caa</span><span class="mi">55</span><span class="err">e</span><span class="mi">2</span><span class="err">a</span><span class="mi">982081</span><span class="err">b</span><span class="mi">793</span><span class="err">c</span><span class="mi">99</span><span class="err">dc</span><span class="mi">95</span><span class="err">a</span><span class="mi">7</span><span class="err">ca</span><span class="mi">3</span><span class="err">d</span><span class="mi">5</span><span class="err">&amp;token=</span><span class="mi">943827</span><span class="err">c</span><span class="mi">8075</span><span class="err">eb</span><span class="mi">9</span><span class="err">b</span><span class="mi">3960</span><span class="err">bf</span><span class="mi">95</span><span class="err">ee</span><span class="mi">304</span><span class="err">b</span><span class="mi">57</span><span class="err">a'</span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="err">'source'</span><span class="p">:</span><span class="w"> </span><span class="err">'LANDSAT/LC</span><span class="mi">08</span><span class="err">/C</span><span class="mi">01</span><span class="err">/T</span><span class="mi">1</span><span class="err">_RT_TOA/LC</span><span class="mi">08</span><span class="err">_</span><span class="mi">207040</span><span class="err">_</span><span class="mi">20191117</span><span class="err">'</span><span class="p">,</span><span class="w">
    </span><span class="err">'thumbnail_url'</span><span class="p">:</span><span class="w"> </span><span class="err">'https</span><span class="p">:</span><span class="err">//earthengine.googleapis.com/api/thumb?thumbid=</span><span class="mi">8</span><span class="err">af</span><span class="mi">65</span><span class="err">bde</span><span class="mi">5696</span><span class="err">bd</span><span class="mi">2189</span><span class="err">a</span><span class="mi">225</span><span class="err">a</span><span class="mi">7</span><span class="err">dff</span><span class="mi">5</span><span class="err">d</span><span class="mi">346</span><span class="err">&amp;token=</span><span class="mi">6087176665</span><span class="err">a</span><span class="mi">1</span><span class="err">bbbe</span><span class="mi">72604</span><span class="err">b</span><span class="mi">810</span><span class="err">f</span><span class="mi">72</span><span class="err">f</span><span class="mi">308</span><span class="err">'</span><span class="p">}],</span><span class="w">
  </span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="err">None</span><span class="p">,</span><span class="w">
  </span><span class="err">'type'</span><span class="p">:</span><span class="w"> </span><span class="err">'recentimages-thumbs'</span><span class="p">}}</span><span class="w">
</span></code></pre>
          <h1 id="user-management">User Management</h1>

<p>The following endpoints expose the API&rsquo;s functionality regarding user management.
For more information or implementation details, see <a href="https://github.com/control-tower/ct-oauth-plugin">the source code</a>.</p>

<h2 id="login-email-password">Login (email + password)</h2>

<p>Login endpoints support both HTML and JSON output formats, depending on the <code class="prettyprint">Content-type</code> provided in the request. Keep in mind that HTML-based requests will result in redirects - for example, after successfully logging in, you will be taken to <code class="prettyprint">/auth/success</code> - while JSON based requests will simply return the matching HTTP code - 200 in case of a successful login.</p>

<h3 id="get-lt-base-api-url-gt-auth">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/</code></h3>

<p>Convenience URL that redirects to <code class="prettyprint">&lt;BASE API URL&gt;/auth/login</code></p>

<h3 id="get-lt-base-api-url-gt-auth-login">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/login</code></h3>

<p>Basic API auth login page. Only supported for HTML requests.</p>

<h3 id="post-lt-base-api-url-gt-auth-login">POST <code class="prettyprint">&lt;BASE API URL&gt;/auth/login</code></h3>

<p>Endpoint for email + password based login.</p>

<p>For HTML requests, it will redirect to either <code class="prettyprint">&lt;BASE API URL&gt;/auth/success</code> or <code class="prettyprint">&lt;BASE API URL&gt;/auth/fail</code> depending on whether the login was successful or not. An optional <code class="prettyprint">callbackUrl</code> query parameter can be provided, in which case the user will be redirected to that URL in case of login success.</p>

<p>For JSON requests, it will return 200 or 401 HTTP response code depending on whether the login was successful or not. In case of successful logins, the basic user details will be returned as a JSON object.</p>
<pre class="highlight shell"><code><span class="c"># Email + password based login - JSON format</span>
curl -X POST http://api.skydipper.com/auth/login <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"your-email@provider.com",
    "password":"potato"
}'</span>
</code></pre><pre class="highlight plaintext"><code>// Response:
{
  "data": {
    "email": "your-email@provider.com",
    "createdAt": "2018-11-15T04:46:35.313Z",
    "role": "USER",
    "extraUserData": {
      "apps": [
        "skydipper"
      ]
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjViZWNmYTJiNjdkYTBkM2VjMDdhMjdmNiIsInJvbGUiOiJVU0VSIiwicHJvdmlkZXIiOiJsb2NhbCIsImVtYWlsIjoidGVzdEBleGFtcGxlLmNvbSIsImV4dHJhVXNlckRhdGEiOnsiYXBwcyI6WyJydyJdfSwiY3JlYXRlZEF0IjoxNTQzMzE1NzMxNzcwLCJpYXQiOjE1NDMzMTU3MzF9.kIdkSOb7mCMOxE2ipqVOBrK7IefAjLDhaPG9DT1qvCw"
  }
}
</code></pre>
<h3 id="get-lt-base-api-url-gt-auth-fail">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/fail</code></h3>

<p>Displays login errors for HTML requests. Not supported on JSON requests.</p>

<h3 id="get-lt-base-api-url-gt-auth-check-logged">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/check-logged</code></h3>

<p>Check login status</p>

<h3 id="get-lt-base-api-url-gt-auth-success">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/success</code></h3>

<p>Successful login page for HTML requests. Not supported on JSON requests.</p>

<h3 id="get-lt-base-api-url-gt-auth-logout">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/logout</code></h3>

<p>Login invalidation endpoint</p>

<h3 id="get-lt-base-api-url-gt-auth-generate-token">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/generate-token</code></h3>

<p>Generates a JWT token for the current user session.</p>

<h2 id="login-3rd-party-oauth">Login (3rd party oauth)</h2>

<ul>
<li>GET &rsquo;<BASE API URL>/auth/twitter&rsquo; - Starts authentication using the configured Twitter settings</li>
<li>GET &rsquo;<BASE API URL>/auth/twitter/callback&rsquo; - Callback used once Twitter auth is done</li>
<li>GET &rsquo;<BASE API URL>/auth/google&rsquo; - Starts authentication using the configured Google settings</li>
<li>GET &rsquo;<BASE API URL>/auth/google/callback&rsquo; - Callback used once Google auth is done</li>
<li>GET &rsquo;<BASE API URL>/auth/google/token&rsquo; - Endpoint that expects the Google token used by the API to validate the user session.</li>
<li>GET &rsquo;<BASE API URL>/auth/facebook&rsquo; - Starts authentication using the configured Google settings</li>
<li>GET &rsquo;<BASE API URL>/auth/facebook/callback&rsquo; - Callback used once Facebook auth is done</li>
<li>GET &rsquo;<BASE API URL>/auth/facebook/token&rsquo; - Endpoint that expects the Facebook token used by the API to validate the user session.</li>
</ul>

<h2 id="registration">Registration</h2>

<p>Registration endpoints support both HTML and JSON output formats, depending on the <code class="prettyprint">Content-type</code> provided in the request.</p>

<h3 id="get-lt-base-api-url-gt-auth-sign-up">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/sign-up</code></h3>

<p>Account creation page, for accounts using email + password based login for HTML requests. Not supported on JSON requests.</p>

<h3 id="post-lt-base-api-url-gt-auth-sign-up">POST <code class="prettyprint">&lt;BASE API URL&gt;/auth/sign-up</code></h3>

<p>Account creation endpoint, for accounts using email + password based login for both HTML and JSON requests.</p>

<p>For HTML requests, it will display a message informing about any validation error, or informing the user in case of success.</p>

<p>For JSON requests, it will return 200 or 422 HTTP response code depending on whether the login was successful or not. In case of successful logins, the basic user details will be returned as a JSON object. In case of failure, an array of errors is returned.</p>

<p>While optional, it&rsquo;s highly recommended that you specify which apps the user will be granted access to, as most API operation validate the user&rsquo;s apps match datasets, widgets, etc.</p>
<pre class="highlight shell"><code><span class="c"># Account creation using email + password</span>
curl -X POST http://api.skydipper.com/auth/sign-up <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"your-email@provider.com",
    "password":"potato",
    "repeatPassword":"potato",
    "apps": ["skydipper"]
}'</span>
</code></pre><pre class="highlight plaintext"><code>// Response:
{
  "data": {
    "id": "5bfd237767b3176dd63f2eb7",
    "email": "your-email@provider.com",
    "createdAt": "2018-11-27T10:59:03.531Z",
    "role": "USER",
    "extraUserData": {
      "apps": ["skydipper"]
    }
  }
}

</code></pre>
<h3 id="get-lt-base-api-url-gt-auth-confirm-token">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/confirm/:token</code></h3>

<p>Endpoint used in the user validation email to confirm the address upon registration. </p>

<p>It accepts an optional <code class="prettyprint">callbackUrl</code> query parameter with an URL to which the user will be redirect if the confirmation succeeds.</p>

<p>Should no <code class="prettyprint">callbackUrl</code> be provided, the user is redirected to an URL based on the first application associated to their user account - see <code class="prettyprint">ct-oauth-plugin</code> configuration for more info.</p>

<p>Should that application have no configured redirect URL, or the user have no configured app, they are redirect to a platform-wide default URL - see <code class="prettyprint">ct-oauth-plugin</code> configuration for more info.</p>

<h2 id="password-recovery">Password recovery</h2>

<p>Password recovery endpoints support both HTML and JSON output formats, depending on the <code class="prettyprint">Content-type</code> provided in the request.</p>

<h3 id="get-lt-base-api-url-gt-auth-reset-password">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/reset-password</code></h3>

<p>Displays the password reset form page.</p>

<h3 id="post-lt-base-api-url-gt-auth-reset-password">POST <code class="prettyprint">&lt;BASE API URL&gt;/auth/reset-password</code></h3>

<p>Endpoint where the password reset request is sent.</p>
<pre class="highlight shell"><code><span class="c"># Password reset</span>
curl -X POST http://api.skydipper.com/auth/reset-password <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "email":"your-email@provider.com"
}'</span>
</code></pre>
<h3 id="get-lt-base-api-url-gt-auth-reset-password-token">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/reset-password/:token</code></h3>

<p>Endpoint used to validate email address upon password reset request.</p>

<h3 id="post-lt-base-api-url-gt-auth-reset-password-token">POST <code class="prettyprint">&lt;BASE API URL&gt;/auth/reset-password/:token</code></h3>

<p>Endpoint used to submit the new password.</p>
<pre class="highlight shell"><code><span class="c"># New password submission</span>
curl -X POST http://api.skydipper.com/auth/reset-password/&lt;email token&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
 <span class="s1">'{
    "password":"potato",
    "repeatPassword":"potato"
}'</span>
</code></pre>
<h2 id="user-details-management">User details management</h2>

<h3 id="get-lt-base-api-url-gt-auth-user">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/user</code></h3>

<p>Lists user accounts:</p>

<ul>
<li>Only users with role ADMIN have permissions to use this endpoint.</li>
<li>Email+password based accounts that have not had their email address confirmed will not be listed by this endpoint.</li>
<li>Only users belonging to the same apps as the requesting user will be shown. </li>
</ul>

<p>This endpoint supports the following optional filter params:</p>

<ul>
<li>name</li>
<li>email</li>
<li>provider</li>
<li>role</li>
</ul>
<pre class="highlight shell"><code><span class="c"># Lists all currently active users belonging to the same apps as the requester</span>
curl -X GET http://api.skydipper.com/auth/user
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>


<span class="c"># User listing, filter by email address</span>
curl -X GET http://api.skydipper.com/auth/user?email<span class="o">=</span>my.address@email.com
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
</code></pre>
<h3 id="get-lt-base-api-url-gt-auth-user-id">GET <code class="prettyprint">&lt;BASE API URL&gt;/auth/user/:id</code></h3>
<pre class="highlight shell"><code><span class="c"># shows info for user with the given id</span>
curl -X GET http://api.skydipper.com/auth/user/&lt;user_id&gt;
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
</code></pre>
<h3 id="patch-lt-base-api-url-gt-auth-user-me">PATCH <code class="prettyprint">&lt;BASE API URL&gt;/auth/user/me</code></h3>

<ul>
<li>Updates current user details.</li>
<li>Can be used by any user.</li>
<li>Supported fields: <code class="prettyprint">name</code>, <code class="prettyprint">photo</code> and <code class="prettyprint">email</code> (except on 3rd party auth)</li>
<li>Returns the new state of the updated user object.</li>
</ul>
<pre class="highlight shell"><code><span class="c"># updates current user details</span>
curl -X PATCH http://api.skydipper.com/auth/user/me
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
 <span class="s1">'{
    "name":"new-name",
    "photo": "https://an.image.url/photo.jpg",
    ...
}'</span>
</code></pre>
<h3 id="patch-lt-base-api-url-gt-auth-user-id">PATCH <code class="prettyprint">&lt;BASE API URL&gt;/auth/user/:id</code></h3>

<ul>
<li>Updates specified user details.</li>
<li>Can only be used by admins.</li>
<li>Supported fields: <code class="prettyprint">name</code>, <code class="prettyprint">photo</code> and <code class="prettyprint">email</code> (except on 3rd party auth)</li>
<li>Returns the new state of the updated user object.</li>
</ul>
<pre class="highlight shell"><code><span class="c"># updates details of user given its id</span>
curl -X PATCH http://api.skydipper.com/auth/user/&lt;user_id&gt;
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
 <span class="s1">'{
    "name":"new-name",
    "photo": "https://an.image.url/photo.jpg",
    ...
}'</span>
</code></pre>
<h3 id="delete-lt-base-api-url-gt-auth-user-id">DELETE <code class="prettyprint">&lt;BASE API URL&gt;/auth/user/:id</code></h3>

<ul>
<li>Deletes the specified user account.</li>
<li>Can only be used by admins.</li>
<li>Returns the deleted user object.</li>
</ul>

<aside class="notice">
This action only deletes the user account. Any resources that may be associated with this given user account are not modified or deleted.
</aside>
<pre class="highlight shell"><code><span class="c"># updates details of user given its id</span>
curl -X DELETE http://api.skydipper.com/auth/user/&lt;user_id&gt;
-H <span class="s2">"Content-Type: application/json"</span>  -d <span class="se">\</span>
-H <span class="s2">"Authorization: Bearer &lt;your-token&gt;"</span> <span class="se">\</span>
 <span class="s1">'{
    "name":"user name",
    "email":"user@email.com",
    "photo": "https://an.image.url/photo.jpg",
    ...
}'</span>
</code></pre>
          <h1 id="errors">Errors</h1>

<p>The Skydipper API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request is incomplete or contains errors</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is incorrect</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that is not json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

          <h1 id="api-attribution-requirements">API attribution requirements</h1>

<p>By using the Skydipper API, you agree to the Skydipper <a href="//skydipper.com/terms-of-service">terms of service</a> and <a href="//skydipper.com/api-attribution-requirements">attribution requirements</a>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
